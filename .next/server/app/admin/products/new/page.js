(()=>{var e={};e.id=8573,e.ids=[8573],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},84226:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>o.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c}),t(57583),t(9457),t(64968),t(35866);var s=t(23191),a=t(88716),i=t(37922),o=t.n(i),n=t(95231),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);t.d(r,l);let c=["",{children:["admin",{children:["products",{children:["new",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,57583)),"/Users/kofitaylor/business/ecommerce-engine-frontend/src/app/admin/products/new/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,9457)),"/Users/kofitaylor/business/ecommerce-engine-frontend/src/app/admin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,64968)),"/Users/kofitaylor/business/ecommerce-engine-frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/kofitaylor/business/ecommerce-engine-frontend/src/app/admin/products/new/page.tsx"],u="/admin/products/new/page",p={require:t,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/products/new/page",pathname:"/admin/products/new",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},1728:(e,r,t)=>{Promise.resolve().then(t.bind(t,7609))},7609:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>y});var s=t(10326),a=t(17577),i=t(35047),o=t(90434),n=t(74723),l=t(68284),c=t(770),d=t(55137),u=t(24660),p=t(30098),m=t(86333),x=t(75248),g=t(68230);let h=c.Ry({name:c.Z_().min(1,"Name is required").max(255),description:c.Z_().optional(),price:c.oQ.number().positive("Price must be positive"),compareAtPrice:c.oQ.number().positive().optional().or(c.i0("")),sku:c.Z_().min(1,"SKU is required").max(100),categoryId:c.Z_().min(1,"Category is required"),stockQuantity:c.oQ.number().int().min(0,"Stock cannot be negative"),active:c.O7().default(!0),featured:c.O7().default(!1)});function y(){let e=(0,i.useRouter)(),{user:r}=(0,x.t)(),t=(0,a.useMemo)(()=>r?(0,g.Zu)(r.roles):null,[r?.roles?.join("|")]);(0,a.useRef)(null);let[c,y]=(0,a.useState)([]),[b,f]=(0,a.useState)(!1),[j,v]=(0,a.useState)(null),[N,P]=(0,a.useState)(null),[w,k]=(0,a.useState)({}),[q,I]=(0,a.useState)(null),{register:_,handleSubmit:S,watch:A,formState:{errors:C}}=(0,n.cI)({resolver:(0,l.F)(h),defaultValues:{active:!0,featured:!1,stockQuantity:0}}),Q=A("categoryId");(0,a.useCallback)(async()=>{try{let e=await d.x.get("/admin/categories");y(e.data.data||[])}catch(e){console.error("Failed to fetch categories",e)}},[]);let U=async r=>{f(!0),v(null),P(null);try{let t={name:r.name,description:r.description,price:r.price,compareAtPrice:r.compareAtPrice||void 0,sku:r.sku,categoryId:r.categoryId,attributes:w,active:r.active,featured:r.featured},s=await d.x.post("/admin/products",t),a=s.data.data?.product?.id,i=!1;if(a&&q)try{let e=new FormData;e.append("file",q),await d.x.post(`/admin/products/${a}/image`,e,{headers:{"Content-Type":"multipart/form-data"}})}catch(e){console.error("Failed to upload image during product creation",e),i=!0}if(a){let e="number"==typeof r.stockQuantity?r.stockQuantity:0;try{await d.x.post(`/admin/inventory/${a}?initialStock=${e}`)}catch(e){console.error("Failed to create initial inventory",e),P("Product created, but inventory setup failed. Please update stock from the edit page.")}}if(a){let r=i?"&image=failed":"";e.push(`/admin/products/${a}?new=true${r}`)}else e.push("/admin/products")}catch(e){console.error("Failed to create product",e),v(e.response?.data?.message||"Failed to create product. Please try again.")}finally{f(!1)}};return r&&!t?.canCreateProducts?null:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[s.jsx(o.default,{href:"/admin/products",className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(m.Z,{className:"h-5 w-5"})}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Add New Product"})]}),j&&s.jsx("div",{className:"p-4 bg-error-bg text-error rounded-lg",children:j}),N&&s.jsx("div",{className:"p-4 bg-yellow-50 text-yellow-800 rounded-lg",children:N}),s.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,s.jsxs)("p",{className:"text-sm text-blue-800",children:[s.jsx("strong",{children:"Note:"})," You can optionally choose an image now. We'll upload it after the product is created and the backend will generate the thumbnail. You'll still be redirected to the edit page."]})}),(0,s.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Product Image (Optional)"}),s.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Upload a main product image. The backend will create a thumbnail for small screens."}),s.jsx(u.Ur,{currentImage:null,onUpload:async e=>{I(e)},onRemove:()=>I(null),disabled:b})]}),(0,s.jsxs)("form",{onSubmit:S(U),className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsx("div",{className:"md:col-span-2",children:s.jsx(u.II,{label:"Product Name",placeholder:"Enter product name",error:C.name?.message,..._("name")})}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),s.jsx("textarea",{placeholder:"Enter product description",rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-primary focus:ring-1 focus:ring-primary resize-none",..._("description")}),C.description&&s.jsx("p",{className:"mt-1 text-sm text-error",children:C.description.message})]}),s.jsx(u.II,{label:"SKU",placeholder:"e.g., WG-PROD-001",error:C.sku?.message,..._("sku")}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),(0,s.jsxs)("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-primary focus:ring-1 focus:ring-primary",..._("categoryId"),children:[s.jsx("option",{value:"",children:"Select a category"}),c.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]}),C.categoryId&&s.jsx("p",{className:"mt-1 text-sm text-error",children:C.categoryId.message})]}),s.jsx(u.II,{label:"Price (GHS)",type:"number",step:"0.01",placeholder:"0.00",error:C.price?.message,..._("price")}),s.jsx(u.II,{label:"Compare at Price (GHS)",type:"number",step:"0.01",placeholder:"0.00 (optional)",error:C.compareAtPrice?.message,..._("compareAtPrice")}),s.jsx(u.II,{label:"Stock Quantity",type:"number",placeholder:"0",error:C.stockQuantity?.message,..._("stockQuantity")}),(0,s.jsxs)("div",{className:"flex items-center gap-6",children:[(0,s.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",..._("active")}),s.jsx("span",{className:"text-sm text-gray-700",children:"Active"})]}),(0,s.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",..._("featured")}),s.jsx("span",{className:"text-sm text-gray-700",children:"Featured"})]})]})]}),(0,s.jsxs)("div",{className:"mt-8 pt-6 border-t border-gray-200 flex justify-end gap-4",children:[s.jsx(o.default,{href:"/admin/products",children:s.jsx(u.zx,{type:"button",variant:"outline",children:"Cancel"})}),s.jsx(u.zx,{type:"submit",isLoading:b,children:"Create Product"})]})]}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm",children:s.jsx(p.x,{attributes:w,onChange:k,categoryId:Q})})]})}},57583:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(68570).createProxy)(String.raw`/Users/kofitaylor/business/ecommerce-engine-frontend/src/app/admin/products/new/page.tsx#default`)}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[9977,2948,8454,7215,1984,4660,889,1211],()=>t(84226));module.exports=s})();