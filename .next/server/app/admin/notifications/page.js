(()=>{var e={};e.id=7395,e.ids=[7395],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},91898:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>c}),r(5053),r(9457),r(64968),r(35866);var a=r(23191),s=r(88716),n=r(37922),i=r.n(n),l=r(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let c=["",{children:["admin",{children:["notifications",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,5053)),"/Users/kofitaylor/business/ecommerce-engine-frontend/src/app/admin/notifications/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,9457)),"/Users/kofitaylor/business/ecommerce-engine-frontend/src/app/admin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,64968)),"/Users/kofitaylor/business/ecommerce-engine-frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/kofitaylor/business/ecommerce-engine-frontend/src/app/admin/notifications/page.tsx"],u="/admin/notifications/page",m={require:r,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/admin/notifications/page",pathname:"/admin/notifications",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},81963:(e,t,r)=>{Promise.resolve().then(r.bind(r,55123))},69669:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},36283:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},77506:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},57671:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},63685:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(62881).Z)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},55123:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>A});var a=r(10326),s=r(17577),n=r(35047),i=r(90434),l=r(55137),o=r(24660),c=r(63171),d=r(48705),u=r(50949),m=r(57671),x=r(69669),p=r(28916),g=r(18019),h=r(62881);let y=(0,h.Z)("check-check",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]),f=(0,h.Z)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);var b=r(6507),j=r(30361),v=r(75248),N=r(68230);let k={LOW_STOCK:{icon:d.Z,color:"text-yellow-500",bg:"bg-yellow-50"},OUT_OF_STOCK:{icon:u.Z,color:"text-red-500",bg:"bg-red-50"},ORDER_PLACED:{icon:m.Z,color:"text-blue-500",bg:"bg-blue-50"},ORDER_CANCELLED:{icon:x.Z,color:"text-gray-600",bg:"bg-gray-100"},PAYMENT_FAILED:{icon:p.Z,color:"text-red-500",bg:"bg-red-50"},ANNOUNCEMENT:{icon:g.Z,color:"text-indigo-500",bg:"bg-indigo-50"},SYSTEM_ALERT:{icon:u.Z,color:"text-gray-500",bg:"bg-gray-50"},INVENTORY_ADJUSTMENT:{icon:d.Z,color:"text-blue-500",bg:"bg-blue-50"}},w={INFO:{label:"Info",color:"bg-blue-100 text-blue-800"},WARNING:{label:"Warning",color:"bg-yellow-100 text-yellow-800"},CRITICAL:{label:"Critical",color:"bg-red-100 text-red-800"}};function A(){(0,n.useRouter)();let{user:e}=(0,v.t)(),t=(0,s.useMemo)(()=>e?(0,N.Zu)(e.roles):null,[e?.roles?.join("|")]);(0,s.useRef)(null);let[r,d]=(0,s.useState)([]),[u,m]=(0,s.useState)(!0),[x,p]=(0,s.useState)("all"),[h,A]=(0,s.useState)("all"),[C,E]=(0,s.useState)(!1),[S,T]=(0,s.useState)(null),[_,q]=(0,s.useState)(""),[M,O]=(0,s.useState)(""),[P,Z]=(0,s.useState)(!1),[R,I]=(0,s.useState)(null),[L,D]=(0,s.useState)("notifications");(0,s.useCallback)(async()=>{m(!0),T(null);try{let e="/admin/notifications";C?e="/admin/notifications/unread":"all"!==x?e=`/admin/notifications/type/${x}`:"all"!==h&&(e=`/admin/notifications/severity/${h}`);let t=await l.x.get(e);d(t.data.data?.content||t.data.data||[])}catch(e){console.error("Failed to fetch notifications",e),d([]),T("Failed to load notifications.")}finally{m(!1)}},[C,x,h]);let F=async e=>{T(null);try{await l.x.post(`/admin/notifications/${e}/read`),d(t=>t.map(t=>t.id===e?{...t,read:!0}:t))}catch(e){console.error("Failed to mark as read",e),T("Failed to mark notification as read.")}},U=async()=>{T(null);try{await l.x.post("/admin/notifications/read-all"),d(e=>e.map(e=>({...e,read:!0})))}catch(e){console.error("Failed to mark all as read",e),T("Failed to mark all notifications as read.")}},z=async()=>{if(!_.trim()||!M.trim()){I("Title and message are required.");return}Z(!0),I(null);try{let e=await l.x.post("/admin/notifications/announcements",{title:_.trim(),message:M.trim()}),t=e.data.data?.emailsQueued;I("number"==typeof t?`Announcement queued for ${t} customers.`:"Announcement queued successfully."),q(""),O("")}catch(e){console.error("Failed to send announcement",e),I("Failed to send announcement.")}finally{Z(!1)}},Y=e=>{if(!e.entityType||!e.entityId)return null;switch(e.entityType){case"ORDER":return"/admin/orders";case"PRODUCT":return"/admin/products";case"PAYMENT":return"/admin/payments";case"USER":return"/admin/customers";default:return null}},G=e=>{let t=new Date(e),r=Math.floor((new Date().getTime()-t.getTime())/36e5),a=Math.floor(r/24);return r<1?"Just now":r<24?`${r}h ago`:a<7?`${a}d ago`:t.toLocaleDateString("en-GB",{day:"numeric",month:"short"})},W=r.filter(e=>!e.read).length,H=r.filter(e=>(!C||!e.read)&&("all"===x||e.type===x)&&("all"===h||e.severity===h));return e&&!t?.canViewNotifications?null:u?(0,a.jsxs)("div",{className:"space-y-6",children:[a.jsx(o.Od,{className:"h-10 w-64"}),a.jsx("div",{className:"space-y-4",children:[1,2,3,4,5].map(e=>a.jsx(o.Od,{className:"h-24 w-full"},e))})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Notifications"}),W>0&&(0,a.jsxs)("span",{className:"px-2 py-1 bg-primary text-white text-xs rounded-full",children:[W," unread"]})]}),W>0&&(0,a.jsxs)(o.zx,{variant:"outline",onClick:U,children:[a.jsx(y,{className:"h-4 w-4 mr-2"}),"Mark all as read"]})]}),S&&a.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",children:S}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",onClick:()=>D("notifications"),className:(0,c.cn)("px-4 py-2 rounded-lg text-sm font-medium","notifications"===L?"bg-primary text-white":"bg-white border border-gray-200 text-gray-700 hover:bg-gray-50"),children:"Notifications"}),a.jsx("button",{type:"button",onClick:()=>D("announcements"),className:(0,c.cn)("px-4 py-2 rounded-lg text-sm font-medium","announcements"===L?"bg-primary text-white":"bg-white border border-gray-200 text-gray-700 hover:bg-gray-50"),children:"Broadcast Announcement"})]}),"announcements"===L&&t?.canSendAnnouncements&&(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6 space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Broadcast Announcement"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Send an email announcement to all customers."})]}),(0,a.jsxs)("div",{className:"grid gap-4",children:[a.jsx(o.II,{label:"Title",value:_,onChange:e=>q(e.target.value),placeholder:"Announcement title"}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),a.jsx("textarea",{value:M,onChange:e=>O(e.target.value),placeholder:"Write your announcement message...",className:"w-full min-h-[120px] rounded-lg border border-gray-300 px-3 py-2 text-sm focus:ring-2 focus:ring-primary focus:border-transparent"})]}),R&&a.jsx("div",{className:"text-sm text-gray-600",children:R}),a.jsx(o.zx,{onClick:z,disabled:P,children:P?"Sending...":"Send Announcement"})]})]}),"announcements"===L&&!t?.canSendAnnouncements&&a.jsx("div",{className:"rounded-lg border border-yellow-200 bg-yellow-50 px-4 py-3 text-sm text-yellow-700",children:"You do not have permission to send announcements."}),"notifications"===L&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(f,{className:"h-4 w-4 text-gray-400"}),(0,a.jsxs)("select",{value:x,onChange:e=>p(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm",children:[a.jsx("option",{value:"all",children:"All Types"}),a.jsx("option",{value:"LOW_STOCK",children:"Low Stock"}),a.jsx("option",{value:"OUT_OF_STOCK",children:"Out of Stock"}),a.jsx("option",{value:"ORDER_PLACED",children:"Order Placed"}),a.jsx("option",{value:"ORDER_CANCELLED",children:"Order Cancelled"}),a.jsx("option",{value:"PAYMENT_FAILED",children:"Payment Failed"}),a.jsx("option",{value:"ANNOUNCEMENT",children:"Announcement"}),a.jsx("option",{value:"SYSTEM_ALERT",children:"System Alert"}),a.jsx("option",{value:"INVENTORY_ADJUSTMENT",children:"Inventory Adjustment"})]})]}),(0,a.jsxs)("select",{value:h,onChange:e=>A(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm",children:[a.jsx("option",{value:"all",children:"All Severity"}),a.jsx("option",{value:"INFO",children:"Info"}),a.jsx("option",{value:"WARNING",children:"Warning"}),a.jsx("option",{value:"CRITICAL",children:"Critical"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:C,onChange:e=>E(e.target.checked),className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),a.jsx("span",{className:"text-sm text-gray-700",children:"Unread only"})]})]}),a.jsx("div",{className:"space-y-4",children:0===H.length?(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[a.jsx(b.Z,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No notifications"}),a.jsx("p",{className:"text-gray-500",children:C?"You've read all your notifications":"No notifications to display"})]}):H.map(e=>{let t=k[e.type]||{icon:g.Z,color:"text-gray-500",bg:"bg-gray-50"},r=t.icon,s=Y(e);return a.jsx("div",{className:(0,c.cn)("bg-white rounded-lg border p-4 transition-all",e.read?"border-gray-200":"border-primary/30 bg-primary/5"),children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:(0,c.cn)("p-2 rounded-lg",t.bg),children:a.jsx(r,{className:(0,c.cn)("h-5 w-5",t.color)})}),a.jsx("div",{className:"flex-1 min-w-0",children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("h3",{className:"font-medium text-gray-900",children:e.title}),a.jsx("span",{className:(0,c.cn)("px-2 py-0.5 text-xs rounded-full",w[e.severity].color),children:w[e.severity].label})]}),a.jsx("p",{className:"text-gray-600 text-sm",children:e.message}),a.jsx("p",{className:"text-gray-400 text-xs mt-2",children:G(e.createdAt)})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[s&&a.jsx(i.default,{href:s,className:"px-3 py-1 text-sm text-primary hover:bg-primary/10 rounded-lg",children:"View"}),!e.read&&a.jsx("button",{onClick:()=>F(e.id),className:"p-2 text-gray-400 hover:text-primary rounded-lg hover:bg-gray-100",title:"Mark as read",children:a.jsx(j.Z,{className:"h-4 w-4"})})]})]})})]})},e.id)})})]})]})}},5053:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(68570).createProxy)(String.raw`/Users/kofitaylor/business/ecommerce-engine-frontend/src/app/admin/notifications/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[9977,2948,1984,4660,889],()=>r(91898));module.exports=a})();