(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8590],{4817:function(t,e,n){Promise.resolve().then(n.bind(n,7926)),Promise.resolve().then(n.bind(n,7677))},6305:function(t,e,n){"use strict";n.d(e,{x:function(){return l}});var r=n(3464),i=n(8488);let a="http://localhost:8080/api/v1",u=!1,o=[],s=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;o.forEach(e=>{t?e.reject(t):e.resolve()}),o=[]},l=r.Z.create({baseURL:a,headers:{"Content-Type":"application/json"},withCredentials:!0});l.interceptors.response.use(t=>t,async t=>{var e;let n=t.config,c=(null==n?void 0:n.url)||"",h=c.includes("/auth/login")||c.includes("/auth/refresh")||c.includes("/auth/logout")||c.includes("/auth/me")||c.includes("/auth/verify-email")||c.includes("/auth/register")||c.includes("/auth/forgot-password")||c.includes("/auth/reset-password");if((null===(e=t.response)||void 0===e?void 0:e.status)===401&&!n._retry&&!h){if(u)return new Promise((t,e)=>{o.push({resolve:t,reject:e})}).then(()=>l(n)).catch(t=>Promise.reject(t));n._retry=!0,u=!0;try{return await r.Z.post("".concat(a,"/auth/refresh"),{},{withCredentials:!0}),s(null),l(n)}catch(e){s(e);let t=i.t.getState();return await t.logout(),window.location.pathname.startsWith("/login")||(window.location.href="/login"),Promise.reject(e)}finally{u=!1}}return Promise.reject(t)})},8488:function(t,e,n){"use strict";n.d(e,{t:function(){return s}});var r=n(3011),i=n(6885),a=n(6305);let u=!1,o=null,s=(0,r.U)()((0,i.tJ)((t,e)=>({user:null,isAuthenticated:!1,isLoading:!0,isRefreshing:!1,setUser:e=>t({user:e,isAuthenticated:!!e}),login:async e=>{let n=await a.x.post("/auth/login",e);try{let e=await a.x.get("/auth/me");t({user:e.data.data,isAuthenticated:!0,isLoading:!1})}catch(e){t({isAuthenticated:!0,isLoading:!1})}return n.data.data},register:async t=>(await a.x.post("/auth/register",t)).data.data,logout:async()=>{t({user:null,isAuthenticated:!1,isRefreshing:!1}),u=!1,o=null;try{await a.x.post("/auth/logout").catch(()=>{})}catch(t){}},refreshToken:async()=>u&&o?o:(u=!0,t({isRefreshing:!0}),o=(async()=>{try{await a.x.post("/auth/refresh");let e=await a.x.get("/auth/me");return t({user:e.data.data,isAuthenticated:!0,isRefreshing:!1}),!0}catch(e){return t({user:null,isAuthenticated:!1,isRefreshing:!1}),!1}finally{u=!1,o=null}})()),checkAuth:async()=>{if(!e().isLoading||!e().isRefreshing){t({isLoading:!0});try{let e=await a.x.get("/auth/me");t({user:e.data.data,isAuthenticated:!0,isLoading:!1})}catch(n){await e().refreshToken()?t({isLoading:!1}):t({user:null,isAuthenticated:!1,isLoading:!1})}}}}),{name:"auth-storage",storage:(0,i.FL)(()=>localStorage),partialize:t=>({user:t.user,isAuthenticated:t.isAuthenticated}),onRehydrateStorage:()=>t=>{t&&(t.isLoading=!1)}}))},7279:function(t,e,n){"use strict";n.d(e,{cn:function(){return a},dS:function(){return f},xG:function(){return u},p6:function(){return o},C7:function(){return s},KP:function(){return l},v2:function(){return h},b6:function(){return c}});var r=n(1994),i=n(3335);function a(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return(0,i.m6)((0,r.W)(e))}function u(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GHS",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en-GH";return new Intl.NumberFormat(n,{style:"currency",currency:e}).format(t)}function o(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{year:"numeric",month:"long",day:"numeric"},n="string"==typeof t?new Date(t):t;return new Intl.DateTimeFormat("en-GH",e).format(n)}function s(t){let e=t.split("-");return e.length>=3?"#".concat(e[e.length-1]):t}function l(t){let e=t.attributes,n=null==e?void 0:e.images;if(!n)return null;if("string"==typeof n){try{let t=JSON.parse(n);if(t&&"object"==typeof t)return t}catch(t){}return null}return"object"!=typeof n?null:n}function c(t){var e,n;let r=l(t);return r?r.thumbnail||r.medium||r.large||r.original||null:t.imageUrl||(null===(n=t.images)||void 0===n?void 0:null===(e=n[0])||void 0===e?void 0:e.url)||null}function h(t){var e,n;let r=l(t);return r?r.original||r.large||r.medium||r.thumbnail||null:t.imageUrl||(null===(n=t.images)||void 0===n?void 0:null===(e=n[0])||void 0===e?void 0:e.url)||null}var d=n(6305);async function f(t){let e=new Map;if(!t||0===t.length)return e;try{((await d.x.post("/store/inventory/batch",t)).data.data||[]).forEach(t=>{t.productId&&e.set(t.productId,t)})}catch(t){console.error("Failed to fetch batch inventory",t)}return e}}},function(t){t.O(0,[2972,6853,5878,5044,2971,2117,1744],function(){return t(t.s=4817)}),_N_E=t.O()}]);