(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2102],{5177:function(e,t,a){Promise.resolve().then(a.bind(a,8295))},6858:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},875:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},9322:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},1671:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},8736:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},3245:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},1817:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},9554:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},4794:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},9397:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},3247:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},6275:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},8930:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},6865:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},7689:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},2489:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},3145:function(e,t,a){"use strict";a.d(t,{default:function(){return s.a}});var r=a(8461),s=a.n(r)},7648:function(e,t,a){"use strict";a.d(t,{default:function(){return s.a}});var r=a(2972),s=a.n(r)},8461:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{default:function(){return i},getImageProps:function(){return l}});let r=a(7043),s=a(5346),n=a(5878),c=r._(a(5084));function l(e){let{props:t}=(0,s.getImgProps)(e,{defaultLoader:c.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,a]of Object.entries(t))void 0===a&&delete t[e];return{props:t}}let i=n.Image},8295:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var r=a(7437),s=a(2265),n=a(7648),c=a(3145),l=a(5162),i=a(6305),d=a(7279),o=a(9714),u=a(6865),m=a(9554),h=a(9397),p=a(8930),x=a(6858);function y(){let{cart:e,isLoading:t,error:a,fetchCart:y,updateQuantity:f,removeItem:g,clearError:v}=(0,l.x)(),{isAuthenticated:j}=(0,l.t)(),[b,k]=(0,s.useState)(new Set),[N,w]=(0,s.useState)({}),[Z,M]=(0,s.useState)(new Map),[I,S]=(0,s.useState)(new Map),O=e=>e.itemKey||e.productId;(0,s.useEffect)(()=>{y()},[j]),(0,s.useEffect)(()=>{if(!(null==e?void 0:e.items)||0===e.items.length)return;let t=e.items.map(e=>e.productId).filter(e=>!N[e]);if(0===t.length)return;let a=!1;return(async()=>{try{let e=await Promise.all(t.map(async e=>{try{let t=await i.x.get("/store/products/".concat(e));return{id:e,product:t.data.data}}catch(e){return null}}));if(a)return;w(t=>{let a=!1,r={...t};return e.forEach(e=>{if(null==e?void 0:e.product){let t=(0,d.b6)(e.product);t&&r[e.id]!==t&&(r[e.id]=t,a=!0)}}),a?r:t})}catch(e){}})(),()=>{a=!0}},[null==e?void 0:e.items,N]),(0,s.useEffect)(()=>{if(!(null==e?void 0:e.items)||0===e.items.length){M(new Map),S(new Map);return}let t=!1;return(async()=>{try{let a=e.items.map(e=>e.productId),r=await (0,d.dS)(a);if(t)return;M(r);let s=new Map;e.items.forEach(e=>{let t=r.get(e.productId),a=O(e);t&&(t.availableQuantity<=0?s.set(a,"Out of stock"):t.availableQuantity<e.quantity?s.set(a,"Only ".concat(t.availableQuantity," available")):t.availableQuantity<=5&&s.set(a,"Low stock: ".concat(t.availableQuantity," left")))}),S(s)}catch(e){}})(),()=>{t=!0}},[null==e?void 0:e.items]);let C=async(e,t,a,r)=>{let s=a||e;k(e=>new Set(e).add(s));try{await f(e,t,a,r)}finally{k(e=>{let t=new Set(e);return t.delete(s),t})}},z=async(e,t)=>{let a=t||e;k(e=>new Set(e).add(a));try{await g(e,t)}finally{k(e=>{let t=new Set(e);return t.delete(a),t})}};if(t)return(0,r.jsxs)("div",{className:"container-wide py-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Shopping Cart"}),(0,r.jsxs)("div",{className:"grid lg:grid-cols-3 gap-8",children:[(0,r.jsx)("div",{className:"lg:col-span-2 space-y-4",children:[1,2,3].map(e=>(0,r.jsx)(o.Od,{className:"h-32 w-full rounded-lg"},e))}),(0,r.jsx)(o.Od,{className:"h-64 w-full rounded-lg"})]})]});if(!e||0===e.items.length)return(0,r.jsx)("div",{className:"container-wide py-12",children:(0,r.jsx)(o.Qd,{})});let A=Array.from(I.values()).some(e=>"Out of stock"===e);return(0,r.jsxs)("div",{className:"container-wide py-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Shopping Cart"}),a&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3",children:[(0,r.jsx)(u.Z,{className:"h-5 w-5 text-red-500 flex-shrink-0"}),(0,r.jsx)("p",{className:"text-red-700 flex-1",children:a}),(0,r.jsx)("button",{onClick:v,className:"text-red-500 hover:text-red-700 text-sm font-medium",children:"Dismiss"})]}),A&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-orange-50 border border-orange-200 rounded-lg flex items-center gap-3",children:[(0,r.jsx)(u.Z,{className:"h-5 w-5 text-orange-500 flex-shrink-0"}),(0,r.jsx)("p",{className:"text-orange-700",children:"Some items in your cart are out of stock. Please remove them to proceed to checkout."})]}),(0,r.jsxs)("div",{className:"grid lg:grid-cols-3 gap-8",children:[(0,r.jsx)("div",{className:"lg:col-span-2 space-y-4",children:e.items.map(e=>{var t;let a=O(e),s=I.get(a),n="Out of stock"===s,l=Z.get(e.productId),i=null!==(t=null==l?void 0:l.availableQuantity)&&void 0!==t?t:999;return(0,r.jsxs)("div",{className:"flex gap-4 p-4 bg-white rounded-lg border ".concat(n?"border-red-300 bg-red-50":s?"border-orange-200":"border-gray-200"),children:[(0,r.jsxs)("div",{className:"relative w-24 h-24 flex-shrink-0 bg-gray-100 rounded-lg overflow-hidden flex items-center justify-center text-gray-400 text-xs",children:[N[e.productId]?(0,r.jsx)(c.default,{src:N[e.productId],alt:e.productName,fill:!0,sizes:"96px",className:"object-cover ".concat(n?"opacity-50":"")}):"No Image",n&&(0,r.jsx)("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white text-xs font-medium",children:"Unavailable"})})]}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"font-medium line-clamp-2 ".concat(n?"text-gray-500":"text-gray-900"),children:e.productName}),(0,r.jsx)("p",{className:"font-semibold mt-1 ".concat(n?"text-gray-400":"text-primary"),children:(0,d.xG)(e.priceAtAdd)}),e.selectedOptions&&Object.keys(e.selectedOptions).length>0&&(0,r.jsx)("div",{className:"mt-2 text-xs text-gray-500 space-y-1",children:Object.entries(e.selectedOptions).map(e=>{let[t,a]=e;return(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"uppercase tracking-wider text-gray-400",children:t}),(0,r.jsx)("span",{className:"font-medium text-gray-600",children:a})]},t)})}),s&&(0,r.jsx)("p",{className:"text-xs mt-1 font-medium ".concat(n?"text-red-600":"text-orange-600"),children:s}),(0,r.jsxs)("div",{className:"flex items-center gap-4 mt-3",children:[(0,r.jsxs)("div",{className:"flex items-center border rounded-lg ".concat(n?"border-gray-200 opacity-50":"border-gray-300"),children:[(0,r.jsx)("button",{onClick:()=>C(e.productId,e.quantity-1,e.itemKey,e.selectedOptions),disabled:e.quantity<=1||b.has(a)||n,className:"p-2 text-gray-500 hover:text-primary disabled:opacity-50",children:(0,r.jsx)(m.Z,{className:"h-4 w-4"})}),(0,r.jsx)("span",{className:"w-10 text-center text-sm font-medium",children:e.quantity}),(0,r.jsx)("button",{onClick:()=>C(e.productId,e.quantity+1,e.itemKey,e.selectedOptions),disabled:b.has(a)||n||e.quantity>=i,className:"p-2 text-gray-500 hover:text-primary disabled:opacity-50",children:(0,r.jsx)(h.Z,{className:"h-4 w-4"})})]}),(0,r.jsx)("button",{onClick:()=>z(e.productId,e.itemKey),disabled:b.has(a),className:"text-gray-400 hover:text-error disabled:opacity-50",children:(0,r.jsx)(p.Z,{className:"h-5 w-5"})})]})]}),(0,r.jsx)("div",{className:"text-right",children:(0,r.jsx)("p",{className:"font-semibold ".concat(n?"text-gray-400 line-through":"text-gray-900"),children:(0,d.xG)(e.subtotal)})})]},a)})}),(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 sticky top-24",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Order Summary"}),(0,r.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,r.jsxs)("div",{className:"flex justify-between text-gray-600",children:[(0,r.jsxs)("span",{children:["Subtotal (",e.itemCount," items)"]}),(0,r.jsx)("span",{children:(0,d.xG)(e.totalAmount)})]}),(0,r.jsxs)("div",{className:"flex justify-between text-gray-600",children:[(0,r.jsx)("span",{children:"Shipping"}),(0,r.jsx)("span",{className:"text-sm",children:"Calculated at checkout"})]})]}),(0,r.jsx)("div",{className:"border-t border-gray-200 pt-4 mb-6",children:(0,r.jsxs)("div",{className:"flex justify-between text-lg font-semibold text-gray-900",children:[(0,r.jsx)("span",{children:"Total"}),(0,r.jsx)("span",{children:(0,d.xG)(e.totalAmount)})]})}),A?(0,r.jsx)(o.zx,{className:"w-full",size:"lg",disabled:!0,children:"Remove Out of Stock Items"}):(0,r.jsx)(n.default,{href:"/checkout",children:(0,r.jsxs)(o.zx,{className:"w-full",size:"lg",children:["Proceed to Checkout",(0,r.jsx)(x.Z,{className:"ml-2 h-5 w-5"})]})}),(0,r.jsx)(n.default,{href:"/products",className:"block text-center mt-4 text-sm text-gray-600 hover:text-primary",children:"Continue Shopping"})]})})]})]})}},5162:function(e,t,a){"use strict";a.d(t,{t:function(){return r.t},x:function(){return c}});var r=a(8488),s=a(3011),n=a(6305);let c=(0,s.U)((e,t)=>({cart:null,isLoading:!1,error:null,fetchCart:async()=>{e({isLoading:!0,error:null});try{let t=await n.x.get("/store/cart");e({cart:t.data.data})}catch(t){e({error:"Failed to load cart"})}finally{e({isLoading:!1})}},addItem:async(t,a,r)=>{e({isLoading:!0,error:null});try{let s=await n.x.post("/store/cart/items",{productId:t,quantity:a,selectedOptions:r});e({cart:s.data.data})}catch(t){var s,c,l;throw"INSUFFICIENT_STOCK"===(null===(l=t.response)||void 0===l?void 0:null===(c=l.data)||void 0===c?void 0:null===(s=c.data)||void 0===s?void 0:s.errorCode)?e({error:"Not enough stock available"}):e({error:"Failed to add item"}),t}finally{e({isLoading:!1})}},updateQuantity:async(a,r,s,c)=>{let l=t().cart,i=e=>s?e.itemKey===s:e.productId===a;l&&e({cart:{...l,items:l.items.map(e=>i(e)?{...e,quantity:r,subtotal:e.priceAtAdd*r}:e),totalAmount:l.items.reduce((e,t)=>i(t)?e+t.priceAtAdd*r:e+t.subtotal,0)}});try{let t=await n.x.put("/store/cart/items/".concat(a),{quantity:r,itemKey:s,selectedOptions:c});e({cart:t.data.data})}catch(t){throw e({cart:l,error:"Failed to update quantity"}),t}},removeItem:async(a,r)=>{let s=t().cart,c=e=>r?e.itemKey===r:e.productId===a;if(s){let t=s.items.filter(e=>!c(e));e({cart:{...s,items:t,itemCount:t.length,totalAmount:t.reduce((e,t)=>e+t.subtotal,0)}})}try{let t=r?"?itemKey=".concat(encodeURIComponent(r)):"",s=await n.x.delete("/store/cart/items/".concat(a).concat(t));e({cart:s.data.data})}catch(t){throw e({cart:s,error:"Failed to remove item"}),t}},clearCart:async()=>{try{await n.x.post("/store/cart/clear"),e({cart:null})}catch(t){throw e({error:"Failed to clear cart"}),t}},clearError:()=>e({error:null})}))}},function(e){e.O(0,[2972,6853,5878,9714,2971,2117,1744],function(){return e(e.s=5177)}),_N_E=e.O()}]);