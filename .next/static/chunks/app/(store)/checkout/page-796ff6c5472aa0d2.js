(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8952],{3482:function(e,t,a){Promise.resolve().then(a.bind(a,4713))},8906:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9205).Z)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},9376:function(e,t,a){"use strict";var s=a(5475);a.o(s,"notFound")&&a.d(t,{notFound:function(){return s.notFound}}),a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})},4713:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var s=a(7437),r=a(2265),i=a(9376),o=a(3145),l=a(9501),n=a(5701),d=a(5162),c=a(6305),u=a(6548),m=a(7279),p=a(9714),g=a(8906);function h(){var e,t,a,h,x,y,f,v,b,w,j,N,A;let _=(0,i.useRouter)(),{cart:P,fetchCart:I,isLoading:Z}=(0,d.x)(),{isAuthenticated:C}=(0,d.t)(),[O,S]=(0,r.useState)(!1),[k,R]=(0,r.useState)(null),[q,E]=(0,r.useState)({}),F=e=>e.itemKey||e.productId,{register:U,handleSubmit:G,watch:M,formState:{errors:K}}=(0,l.cI)({resolver:(0,n.F)(u.$h),defaultValues:{shippingAddress:{},createAccount:!1}}),z=M("createAccount");(0,r.useEffect)(()=>{I()},[C]),(0,r.useEffect)(()=>{if(!(null==P?void 0:P.items)||0===P.items.length)return;let e=P.items.map(e=>e.productId).filter(e=>!q[e]);if(0===e.length)return;let t=!1;return(async()=>{try{let a=await Promise.all(e.map(async e=>{try{let t=await c.x.get("/store/products/".concat(e));return{id:e,product:t.data.data}}catch(e){return null}}));if(t)return;E(e=>{let t=!1,s={...e};return a.forEach(e=>{if(null==e?void 0:e.product){let a=(0,m.b6)(e.product);a&&s[e.id]!==a&&(s[e.id]=a,t=!0)}}),t?s:e})}catch(e){}})(),()=>{t=!0}},[null==P?void 0:P.items,q]);let D=async e=>{var t,a,s,r,i,o;S(!0),R(null);try{let i=null===(t=e.guestEmail)||void 0===t?void 0:t.trim(),o=null===(a=e.guestName)||void 0===a?void 0:a.trim();if(!C&&(!i||!o)){R("Full name and email are required for guest checkout.");return}let l={shippingAddress:e.shippingAddress||null,notes:e.notes||null,guestEmail:i||null,guestName:o||null,createAccount:!!e.createAccount,password:e.createAccount&&e.password||null},n=await c.x.post(C?"/store/orders":"/store/orders/guest",l),d=null===(s=n.data.data)||void 0===s?void 0:s.id;if(!d){R(n.data.message||"Order could not be created. Please try again.");return}let u=crypto.randomUUID(),m=C?{orderId:d,idempotencyKey:u,callbackUrl:"".concat(window.location.origin,"/account/orders/").concat(d,"?verify=true")}:{guestEmail:i,guestName:o,idempotencyKey:u,callbackUrl:"".concat(window.location.origin,"/")},p=await c.x.post(C?"/store/payments/".concat(d,"/initiate"):"/store/payments/".concat(d,"/initiate-guest"),m);(null===(r=p.data.data)||void 0===r?void 0:r.checkoutUrl)?window.location.href=p.data.data.checkoutUrl:_.push(C?"/account/orders/".concat(d):"/")}catch(e){R((null===(o=e.response)||void 0===o?void 0:null===(i=o.data)||void 0===i?void 0:i.message)||"Failed to process order. Please try again.")}finally{S(!1)}};return Z||!P?(0,s.jsx)("div",{className:"container-wide py-8",children:(0,s.jsxs)("div",{className:"grid lg:grid-cols-3 gap-8",children:[(0,s.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,s.jsx)(p.Od,{className:"h-64 w-full rounded-lg"}),(0,s.jsx)(p.Od,{className:"h-48 w-full rounded-lg"})]}),(0,s.jsx)(p.Od,{className:"h-96 w-full rounded-lg"})]})}):0===P.items.length?(_.push("/cart"),null):(0,s.jsxs)("div",{className:"container-wide py-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Checkout"}),(0,s.jsx)("form",{onSubmit:G(D),children:(0,s.jsxs)("div",{className:"grid lg:grid-cols-3 gap-8",children:[(0,s.jsxs)("div",{className:"lg:col-span-2 space-y-8",children:[!C&&(0,s.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Guest Checkout"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-6",children:"Provide your details so we can send order updates and receipts to your email."}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsx)(p.II,{label:"Full Name",placeholder:"Your name",error:null===(e=K.guestName)||void 0===e?void 0:e.message,...U("guestName")}),(0,s.jsx)(p.II,{label:"Email",type:"email",placeholder:"you@example.com",error:null===(t=K.guestEmail)||void 0===t?void 0:t.message,...U("guestEmail")})]}),(0,s.jsxs)("div",{className:"mt-5 space-y-4",children:[(0,s.jsxs)("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,s.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary",...U("createAccount")}),"Create an account for faster checkout next time"]}),z&&(0,s.jsx)(p.II,{label:"Password",type:"password",placeholder:"Create a password",error:null===(a=K.password)||void 0===a?void 0:a.message,...U("password")})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Shipping Address"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsx)("div",{className:"md:col-span-2",children:(0,s.jsx)(p.II,{label:"Street Address",placeholder:"123 Main Street",error:null===(x=K.shippingAddress)||void 0===x?void 0:null===(h=x.street)||void 0===h?void 0:h.message,...U("shippingAddress.street")})}),(0,s.jsx)(p.II,{label:"City",placeholder:"Accra",error:null===(f=K.shippingAddress)||void 0===f?void 0:null===(y=f.city)||void 0===y?void 0:y.message,...U("shippingAddress.city")}),(0,s.jsx)(p.II,{label:"Region / State",placeholder:"Greater Accra",error:null===(b=K.shippingAddress)||void 0===b?void 0:null===(v=b.region)||void 0===v?void 0:v.message,...U("shippingAddress.region")}),(0,s.jsx)(p.II,{label:"Country",placeholder:"Ghana",error:null===(j=K.shippingAddress)||void 0===j?void 0:null===(w=j.country)||void 0===w?void 0:w.message,...U("shippingAddress.country")}),(0,s.jsx)(p.II,{label:"Phone",placeholder:"+233 20 123 4567",type:"tel",error:null===(A=K.shippingAddress)||void 0===A?void 0:null===(N=A.phone)||void 0===N?void 0:N.message,...U("shippingAddress.phone")}),(0,s.jsx)(p.II,{label:"Postal Code (Optional)",placeholder:"00233",...U("shippingAddress.postalCode")}),(0,s.jsx)(p.II,{label:"GPS Address (Optional)",placeholder:"GA-123-4567",...U("shippingAddress.gps")})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Order Notes (Optional)"}),(0,s.jsx)("textarea",{placeholder:"Any special instructions for your order?",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-primary focus:ring-1 focus:ring-primary",rows:3,...U("notes")})]})]}),(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 sticky top-24",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Order Summary"}),(0,s.jsx)("div",{className:"space-y-3 mb-6 max-h-64 overflow-y-auto",children:P.items.map(e=>(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("div",{className:"relative w-16 h-16 bg-gray-100 rounded overflow-hidden flex-shrink-0 flex items-center justify-center text-xs text-gray-400",children:q[e.productId]?(0,s.jsx)(o.default,{src:q[e.productId],alt:e.productName,fill:!0,sizes:"64px",className:"object-cover"}):"No Image"}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900 line-clamp-1",children:e.productName}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["Qty: ",e.quantity]}),e.selectedOptions&&Object.keys(e.selectedOptions).length>0&&(0,s.jsx)("div",{className:"mt-1 text-xs text-gray-500 space-y-1",children:Object.entries(e.selectedOptions).map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"uppercase tracking-wider text-gray-400",children:t}),(0,s.jsx)("span",{className:"font-medium text-gray-600",children:a})]},t)})})]}),(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:(0,m.xG)(e.subtotal)})]},F(e)))}),(0,s.jsxs)("div",{className:"space-y-3 border-t border-gray-200 pt-4 mb-6",children:[(0,s.jsxs)("div",{className:"flex justify-between text-gray-600",children:[(0,s.jsx)("span",{children:"Subtotal"}),(0,s.jsx)("span",{children:(0,m.xG)(P.totalAmount)})]}),(0,s.jsxs)("div",{className:"flex justify-between text-gray-600",children:[(0,s.jsx)("span",{children:"Shipping"}),(0,s.jsx)("span",{children:"Calculated"})]})]}),(0,s.jsx)("div",{className:"border-t border-gray-200 pt-4 mb-6",children:(0,s.jsxs)("div",{className:"flex justify-between text-lg font-semibold text-gray-900",children:[(0,s.jsx)("span",{children:"Total"}),(0,s.jsx)("span",{children:(0,m.xG)(P.totalAmount)})]})}),k&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-error-bg text-error rounded-lg text-sm",children:k}),(0,s.jsx)(p.zx,{type:"submit",className:"w-full",size:"lg",isLoading:O,children:"Complete Order"}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 mt-4 text-xs text-gray-500",children:[(0,s.jsx)(g.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Secure checkout powered by Hubtel"})]})]})})]})})]})}},5162:function(e,t,a){"use strict";a.d(t,{t:function(){return s.t},x:function(){return o}});var s=a(8488),r=a(3011),i=a(6305);let o=(0,r.U)((e,t)=>({cart:null,isLoading:!1,error:null,fetchCart:async()=>{e({isLoading:!0,error:null});try{let t=await i.x.get("/store/cart");e({cart:t.data.data})}catch(t){e({error:"Failed to load cart"})}finally{e({isLoading:!1})}},addItem:async(t,a,s)=>{e({isLoading:!0,error:null});try{let r=await i.x.post("/store/cart/items",{productId:t,quantity:a,selectedOptions:s});e({cart:r.data.data})}catch(t){var r,o,l;throw"INSUFFICIENT_STOCK"===(null===(l=t.response)||void 0===l?void 0:null===(o=l.data)||void 0===o?void 0:null===(r=o.data)||void 0===r?void 0:r.errorCode)?e({error:"Not enough stock available"}):e({error:"Failed to add item"}),t}finally{e({isLoading:!1})}},updateQuantity:async(a,s,r,o)=>{let l=t().cart,n=e=>r?e.itemKey===r:e.productId===a;l&&e({cart:{...l,items:l.items.map(e=>n(e)?{...e,quantity:s,subtotal:e.priceAtAdd*s}:e),totalAmount:l.items.reduce((e,t)=>n(t)?e+t.priceAtAdd*s:e+t.subtotal,0)}});try{let t=await i.x.put("/store/cart/items/".concat(a),{quantity:s,itemKey:r,selectedOptions:o});e({cart:t.data.data})}catch(t){throw e({cart:l,error:"Failed to update quantity"}),t}},removeItem:async(a,s)=>{let r=t().cart,o=e=>s?e.itemKey===s:e.productId===a;if(r){let t=r.items.filter(e=>!o(e));e({cart:{...r,items:t,itemCount:t.length,totalAmount:t.reduce((e,t)=>e+t.subtotal,0)}})}try{let t=s?"?itemKey=".concat(encodeURIComponent(s)):"",r=await i.x.delete("/store/cart/items/".concat(a).concat(t));e({cart:r.data.data})}catch(t){throw e({cart:r,error:"Failed to remove item"}),t}},clearCart:async()=>{try{await i.x.post("/store/cart/clear"),e({cart:null})}catch(t){throw e({error:"Failed to clear cart"}),t}},clearError:()=>e({error:null})}))},6548:function(e,t,a){"use strict";a.d(t,{$h:function(){return c},ek:function(){return l},dm:function(){return i},gY:function(){return o},S4:function(){return n}});var s=a(7119);let r=/^[a-zA-Z0-9_]{3,30}$/,i=s.Ry({usernameOrEmail:s.Z_().min(1,"Username or email is required").refine(e=>s.Z_().email().safeParse(e).success||r.test(e),{message:"Must be a valid email or username"}),password:s.Z_().min(1,"Password is required")}),o=s.Ry({fullName:s.Z_().min(2,"Name must be at least 2 characters"),username:s.Z_().min(3,"Username must be at least 3 characters"),email:s.Z_().email("Invalid email address"),password:s.Z_().min(8,"Password must be at least 8 characters").regex(/[A-Z]/,"Password must contain at least one uppercase letter").regex(/[0-9]/,"Password must contain at least one number"),confirmPassword:s.Z_(),acceptTerms:s.O7().refine(e=>!0===e,{message:"You must accept the terms and conditions"})}).refine(e=>e.password===e.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]}),l=s.Ry({email:s.Z_().email("Invalid email address")}),n=s.Ry({password:s.Z_().min(8,"Password must be at least 8 characters").regex(/[A-Z]/,"Password must contain at least one uppercase letter").regex(/[0-9]/,"Password must contain at least one number"),confirmPassword:s.Z_()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]});s.Ry({name:s.Z_().min(1,"Product name is required").max(255,"Name is too long"),description:s.Z_().optional(),price:s.Rx().positive("Price must be greater than 0"),compareAtPrice:s.Rx().positive("Compare price must be greater than 0").optional(),sku:s.Z_().min(1,"SKU is required").max(100,"SKU is too long"),categoryId:s.Z_().uuid("Please select a category"),active:s.O7().default(!0),featured:s.O7().default(!1),attributes:s.IM(s._4()).optional()}),s.Ry({discountPercentage:s.Rx().min(1,"Minimum 1%").max(99,"Maximum 99%"),startDate:s.Z_().optional(),endDate:s.Z_().optional()}),s.Ry({categoryId:s.Z_().uuid().optional(),applyToAll:s.O7().optional(),discountPercentage:s.Rx().min(1,"Minimum 1%").max(99,"Maximum 99%"),startDate:s.Z_().optional(),endDate:s.Z_().optional()}),s.Ry({name:s.Z_().min(1,"Category name is required").max(100,"Name is too long"),slug:s.Z_().regex(/^[a-z0-9-]*$/,"Slug must contain only lowercase letters, numbers, and hyphens").optional().or(s.i0("")),description:s.Z_().max(500,"Description is too long").optional(),parentId:s.Z_().uuid().nullable().optional(),displayOrder:s.Rx().int().min(0).default(0)});let d=s.Ry({street:s.Z_().min(1,"Street address is required"),city:s.Z_().min(1,"City is required"),region:s.Z_().min(1,"Region/State is required"),country:s.Z_().min(1,"Country is required"),postalCode:s.Z_().optional(),phone:s.Z_().min(1,"Phone number is required"),gps:s.Z_().optional()}),c=s.Ry({shippingAddress:d,guestEmail:s.Z_().email("Valid email is required").optional(),guestName:s.Z_().min(1,"Full name is required").optional(),createAccount:s.O7().optional().default(!1),password:s.Z_().min(8,"Password must be at least 8 characters").optional(),notes:s.Z_().max(500,"Notes too long").optional()}).refine(e=>!e.createAccount||!!e.password,{message:"Password is required to create an account",path:["password"]})}},function(e){e.O(0,[2972,6853,5878,2428,6572,9714,2971,2117,1744],function(){return e(e.s=3482)}),_N_E=e.O()}]);