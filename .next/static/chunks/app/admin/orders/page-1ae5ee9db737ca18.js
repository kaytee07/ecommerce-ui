(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8606],{404:function(e,t,r){Promise.resolve().then(r.bind(r,7613))},875:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},9322:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},1671:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},2208:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},8736:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},3245:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},1817:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},4794:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},3247:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},6275:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},6865:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},7689:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},2489:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(9205).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},3145:function(e,t,r){"use strict";r.d(t,{default:function(){return n.a}});var a=r(8461),n=r.n(a)},7648:function(e,t,r){"use strict";r.d(t,{default:function(){return n.a}});var a=r(2972),n=r.n(a)},9376:function(e,t,r){"use strict";var a=r(5475);r.o(a,"notFound")&&r.d(t,{notFound:function(){return a.notFound}}),r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},8461:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return l},getImageProps:function(){return i}});let a=r(7043),n=r(5346),c=r(5878),s=a._(r(5084));function i(e){let{props:t}=(0,n.getImgProps)(e,{defaultLoader:s.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let l=c.Image},7613:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return x}});var a=r(7437),n=r(2265),c=r(7648),s=r(9376),i=r(6305),l=r(9714),u=r(7279),d=r(2208),o=r(5162),m=r(8588);let f=[{value:"",label:"All Orders"},{value:"PENDING",label:"Pending"},{value:"CONFIRMED",label:"Confirmed"},{value:"PROCESSING",label:"Processing"},{value:"SHIPPED",label:"Shipped"},{value:"DELIVERED",label:"Delivered"},{value:"CANCELLED",label:"Cancelled"},{value:"REFUNDED",label:"Refunded"}];function h(){var e;let t=(0,s.useSearchParams)().get("status")||"",r=(0,s.useRouter)(),{user:h}=(0,o.t)(),x=(0,n.useMemo)(()=>h?(0,m.Zu)(h.roles):null,[null==h?void 0:null===(e=h.roles)||void 0===e?void 0:e.join("|")]),p=(0,n.useRef)(null),[y,g]=(0,n.useState)([]),[v,N]=(0,n.useState)(t),[k,j]=(0,n.useState)(!0),[w,b]=(0,n.useState)({}),A=(0,n.useRef)(!1),E=(0,n.useCallback)(async()=>{j(!0);try{let e=v?"/admin/orders/status/".concat(v):"/admin/orders",t=await i.x.get("".concat(e,"?size=50"));g(t.data.data||[])}catch(e){console.error("Failed to fetch orders",e),g([])}finally{j(!1)}},[v]),P=(0,n.useCallback)(async()=>{if(!A.current)try{var e;let t=new URLSearchParams;t.set("size","1000");let r=await i.x.get("/admin/users?".concat(t.toString())),a=(null===(e=r.data.data)||void 0===e?void 0:e.content)||r.data.data||[],n={};a.forEach(e=>{(null==e?void 0:e.id)&&(null==e?void 0:e.username)&&(n[e.id]=e.username)}),b(n),A.current=!0}catch(e){console.error("Failed to fetch users for order display",e)}},[]);return((0,n.useEffect)(()=>{y.some(e=>e.userId&&!w[e.userId])&&P()},[y,w,P]),(0,n.useEffect)(()=>{if(!h)return;if(!(null==x?void 0:x.canViewAllOrders)){r.push("/admin");return}let e="".concat(h.id||h.username||"user",":").concat(v||"all");p.current!==e&&(p.current=e,E())},[v,h,null==x?void 0:x.canViewAllOrders,r,E]),!h||(null==x?void 0:x.canViewAllOrders))?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Orders"}),(0,a.jsx)(l.Ph,{options:f,value:v,onChange:e=>N(e.target.value),className:"w-48"})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Items"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:k?Array.from({length:5}).map((e,t)=>(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:7,className:"px-6 py-4",children:(0,a.jsx)(l.Od,{className:"h-12 w-full"})})},t)):y&&0!==y.length?y.map(e=>{let t=e.orderNumber||e.orderCode?(0,u.C7)(e.orderNumber||e.orderCode||""):e.id.slice(0,8).toUpperCase(),r=e.customerUsername||e.userUsername||e.customerName||e.guestName||e.guestEmail||w[e.userId]||e.userId;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("p",{className:"font-medium text-gray-900",children:t})}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:r}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:(0,u.p6)(e.createdAt)}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)(l.OE,{status:e.status})}),(0,a.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-500",children:[e.itemCount," item",e.itemCount>1?"s":""]}),(0,a.jsx)("td",{className:"px-6 py-4 font-medium text-gray-900",children:(0,u.xG)(e.totalAmount)}),(0,a.jsx)("td",{className:"px-6 py-4 text-right",children:(0,a.jsxs)(c.default,{href:"/admin/orders/".concat(e.id),className:"inline-flex items-center text-primary hover:underline text-sm",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4 mr-1"}),"View"]})})]},e.id)}):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:"No orders found"})})})]})})})]}):null}function x(){return(0,a.jsx)(n.Suspense,{fallback:(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsx)(l.Od,{className:"h-96 w-full"})}),children:(0,a.jsx)(h,{})})}},8588:function(e,t,r){"use strict";r.d(t,{GJ:function(){return d},Zu:function(){return o}});let a="ROLE_ADMIN",n="ROLE_CONTENT_MANAGER",c="ROLE_SUPPORT_AGENT",s="ROLE_WAREHOUSE",i="ROLE_SUPER_ADMIN";function l(e,t){return e.includes(t)}function u(e,t){return t.some(t=>e.includes(t))}function d(e){return u(e,[a,n,c,s,i])}function o(e){return{canViewAdminProducts:u(e,[n,i]),canCreateProducts:u(e,[n,i]),canEditProducts:u(e,[n,i]),canDeleteProducts:u(e,[n,i]),canManageCategories:u(e,[n,i]),canPermanentDeleteCategories:l(e,i),canViewAllOrders:u(e,[s,n,c,i]),canFulfillOrders:u(e,[s,i]),canCancelOrders:u(e,[n,i]),canViewPayments:u(e,[c,n,i]),canProcessRefunds:u(e,[c,n,i]),canViewUsers:u(e,[a,c,i]),canManageRoles:l(e,i),canViewInventory:u(e,[s,n,i]),canAdjustInventory:u(e,[s,n,i]),canViewAnalytics:u(e,[a,i]),canExportData:l(e,i),canManageStorefront:u(e,[a,i]),canViewNotifications:u(e,[n,s,c,i]),canSendAnnouncements:u(e,[a,i]),canViewAuditLogs:l(e,i),isSuperAdmin:l(e,i)}}},5162:function(e,t,r){"use strict";r.d(t,{t:function(){return a.t},x:function(){return s}});var a=r(8488),n=r(3011),c=r(6305);let s=(0,n.U)((e,t)=>({cart:null,isLoading:!1,error:null,fetchCart:async()=>{e({isLoading:!0,error:null});try{let t=await c.x.get("/store/cart");e({cart:t.data.data})}catch(t){e({error:"Failed to load cart"})}finally{e({isLoading:!1})}},addItem:async(t,r,a)=>{e({isLoading:!0,error:null});try{let n=await c.x.post("/store/cart/items",{productId:t,quantity:r,selectedOptions:a});e({cart:n.data.data})}catch(t){var n,s,i;throw"INSUFFICIENT_STOCK"===(null===(i=t.response)||void 0===i?void 0:null===(s=i.data)||void 0===s?void 0:null===(n=s.data)||void 0===n?void 0:n.errorCode)?e({error:"Not enough stock available"}):e({error:"Failed to add item"}),t}finally{e({isLoading:!1})}},updateQuantity:async(r,a,n,s)=>{let i=t().cart,l=e=>n?e.itemKey===n:e.productId===r;i&&e({cart:{...i,items:i.items.map(e=>l(e)?{...e,quantity:a,subtotal:e.priceAtAdd*a}:e),totalAmount:i.items.reduce((e,t)=>l(t)?e+t.priceAtAdd*a:e+t.subtotal,0)}});try{let t=await c.x.put("/store/cart/items/".concat(r),{quantity:a,itemKey:n,selectedOptions:s});e({cart:t.data.data})}catch(t){throw e({cart:i,error:"Failed to update quantity"}),t}},removeItem:async(r,a)=>{let n=t().cart,s=e=>a?e.itemKey===a:e.productId===r;if(n){let t=n.items.filter(e=>!s(e));e({cart:{...n,items:t,itemCount:t.length,totalAmount:t.reduce((e,t)=>e+t.subtotal,0)}})}try{let t=a?"?itemKey=".concat(encodeURIComponent(a)):"",n=await c.x.delete("/store/cart/items/".concat(r).concat(t));e({cart:n.data.data})}catch(t){throw e({cart:n,error:"Failed to remove item"}),t}},clearCart:async()=>{try{await c.x.post("/store/cart/clear"),e({cart:null})}catch(t){throw e({error:"Failed to clear cart"}),t}},clearError:()=>e({error:null})}))}},function(e){e.O(0,[2972,6853,5878,9714,2971,2117,1744],function(){return e(e.s=404)}),_N_E=e.O()}]);