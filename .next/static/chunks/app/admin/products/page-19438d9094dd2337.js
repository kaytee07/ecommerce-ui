(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4122],{8519:function(e,t,a){Promise.resolve().then(a.bind(a,5658))},875:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},9322:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},1671:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},8736:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},3113:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},3245:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},1817:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},4794:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},9397:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},3247:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},6275:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},8930:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},6865:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},7689:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},2489:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},3145:function(e,t,a){"use strict";a.d(t,{default:function(){return n.a}});var r=a(8461),n=a.n(r)},7648:function(e,t,a){"use strict";a.d(t,{default:function(){return n.a}});var r=a(2972),n=a.n(r)},9376:function(e,t,a){"use strict";var r=a(5475);a.o(r,"notFound")&&a.d(t,{notFound:function(){return r.notFound}}),a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},8461:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{default:function(){return i},getImageProps:function(){return l}});let r=a(7043),n=a(5346),c=a(5878),s=r._(a(5084));function l(e){let{props:t}=(0,n.getImgProps)(e,{defaultLoader:s.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,a]of Object.entries(t))void 0===a&&delete t[e];return{props:t}}let i=c.Image},5658:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var r=a(7437),n=a(2265),c=a(9376),s=a(3145),l=a(7648),i=a(6305),o=a(9714),d=a(7279),u=a(9397),m=a(3247),h=a(3113);let p=(0,a(9205).Z)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var x=a(8930),y=a(5162),f=a(8588);function g(){var e,t;let a=(0,c.useRouter)(),{user:g}=(0,y.t)(),v=(0,n.useMemo)(()=>g?(0,f.Zu)(g.roles):null,[null==g?void 0:null===(e=g.roles)||void 0===e?void 0:e.join("|")]),j=(0,n.useRef)(null),[k,N]=(0,n.useState)([]),[w,b]=(0,n.useState)([]),[S,C]=(0,n.useState)(!0),[P,A]=(0,n.useState)(""),[Z,M]=(0,n.useState)(""),[I,L]=(0,n.useState)({}),[E,O]=(0,n.useState)({open:!1,product:null}),[_,z]=(0,n.useState)(!1),[R,V]=(0,n.useState)(!1),[D,F]=(0,n.useState)(!1),[T,U]=(0,n.useState)(""),[q,H]=(0,n.useState)(""),[G,K]=(0,n.useState)(""),[B,Q]=(0,n.useState)(""),[J,W]=(0,n.useState)(null),[X,Y]=(0,n.useState)(!1),$=(0,n.useCallback)(async()=>{C(!0);try{var e;let t=new URLSearchParams;t.set("size","200");let[a,r]=await Promise.all([i.x.get("/admin/products?".concat(t.toString())),i.x.get("/admin/categories")]),n=((null===(e=a.data.data)||void 0===e?void 0:e.content)||[]).filter(e=>{var t;let a=!P||e.name.toLowerCase().includes(P.toLowerCase())||(null===(t=e.sku)||void 0===t?void 0:t.toLowerCase().includes(P.toLowerCase())),r=!Z||e.categoryId===Z;return a&&r});N(n),b(r.data.data||[]);let c=n.map(e=>e.id);if(c.length>0)try{let e=await i.x.post("/admin/inventory/batch",c),t={};(e.data.data||[]).forEach(e=>{t[e.productId]=e}),L(e=>({...e,...t}))}catch(e){console.error("Failed to fetch inventory batch",e)}}catch(e){console.error("Failed to fetch products",e),N([])}finally{C(!1)}},[P,Z]);(0,n.useEffect)(()=>{if(!g)return;if(!(null==v?void 0:v.canViewAdminProducts)){a.push("/admin");return}let e="".concat(g.id||g.username||"user",":").concat(P,":").concat(Z||"all");j.current!==e&&(j.current=e,$())},[P,Z,g,null==v?void 0:v.canViewAdminProducts,a,$]);let ee=async()=>{if(E.product){z(!0);try{await i.x.delete("/admin/products/".concat(E.product.id)),N(k.filter(e=>{var t;return e.id!==(null===(t=E.product)||void 0===t?void 0:t.id)})),O({open:!1,product:null})}catch(e){console.error("Failed to delete product",e)}finally{z(!1)}}},et=e=>{if(e)return 16===e.length?"".concat(e,":00"):e},ea=async()=>{W(null),Y(!0);try{let e=Number(q);if(Number.isNaN(e)){W("Discount percentage is required.");return}if(!D&&!T){W("Select a category or choose apply to all.");return}let t={discountPercentage:e,applyToAll:D};!D&&T&&(t.categoryId=T);let a=et(G),r=et(B);a&&(t.startDate=a),r&&(t.endDate=r),await i.x.post("/admin/products/bulk-discount",t),V(!1),H(""),K(""),Q(""),await $()}catch(a){var e,t;W((null===(t=a.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||"Failed to apply bulk discount.")}finally{Y(!1)}};return!g||(null==v?void 0:v.canViewAdminProducts)?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Products"}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(o.zx,{variant:"outline",onClick:()=>V(e=>!e),children:"Bulk Discount"}),(0,r.jsx)(l.default,{href:"/admin/products/new",children:(0,r.jsxs)(o.zx,{children:[(0,r.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Add Product"]})})]})]}),R&&(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Apply Bulk Discount"}),(0,r.jsx)(o.zx,{variant:"outline",onClick:()=>V(!1),children:"Close"})]}),J&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-error-bg text-error rounded-lg text-sm",children:J}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[(0,r.jsx)(o.II,{label:"Discount %",type:"number",step:"0.01",min:"0",max:"100",value:q,onChange:e=>H(e.target.value)}),(0,r.jsx)(o.Ph,{label:"Category",options:[{value:"",label:"Select category"},...w.map(e=>({value:e.id,label:e.name}))],value:T,onChange:e=>U(e.target.value),disabled:D}),(0,r.jsx)(o.II,{label:"Start Date (Optional)",type:"datetime-local",value:G,onChange:e=>K(e.target.value)}),(0,r.jsx)(o.II,{label:"End Date (Optional)",type:"datetime-local",value:B,onChange:e=>Q(e.target.value)})]}),(0,r.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,r.jsxs)("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,r.jsx)("input",{type:"checkbox",checked:D,onChange:e=>F(e.target.checked),className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),"Apply to all products"]}),(0,r.jsx)(o.zx,{onClick:ea,isLoading:X,disabled:""===q.trim(),children:"Apply Discount"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)("input",{type:"search",placeholder:"Search products...",value:P,onChange:e=>A(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:border-primary focus:ring-1 focus:ring-primary"}),(0,r.jsx)(m.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"})]}),(0,r.jsx)(o.Ph,{options:[{value:"",label:"All Categories"},...w.map(e=>({value:e.id,label:e.name}))],value:Z,onChange:e=>M(e.target.value),className:"w-48"})]}),(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SKU"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stock"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-gray-200",children:S?Array.from({length:5}).map((e,t)=>(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:7,className:"px-6 py-4",children:(0,r.jsx)(o.Od,{className:"h-12 w-full"})})},t)):k&&0!==k.length?k.map(e=>{var t,a;return(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0",children:(0,d.b6)(e)?(0,r.jsx)(s.default,{src:(0,d.b6)(e),alt:e.name,width:48,height:48,className:"w-full h-full object-cover"}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,r.jsx)(h.Z,{className:"h-5 w-5 text-gray-400"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-gray-900 line-clamp-1",children:e.name}),e.featured&&(0,r.jsx)(o.Ct,{variant:"warning",className:"mt-1",children:"Featured"})]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500 font-mono",children:e.sku}),(0,r.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:e.categoryName}),(0,r.jsxs)("td",{className:"px-6 py-4",children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:(0,d.xG)(e.price)}),e.discountPercentage&&(0,r.jsxs)("p",{className:"text-xs text-error",children:["-",e.discountPercentage,"%"]})]}),(0,r.jsx)("td",{className:"px-6 py-4 text-gray-500",children:null!==(a=null===(t=I[e.id])||void 0===t?void 0:t.availableQuantity)&&void 0!==a?a:"â€”"}),(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsx)(o.Ct,{variant:e.active?"success":"default",children:e.active?"Active":"Inactive"})}),(0,r.jsx)("td",{className:"px-6 py-4 text-right",children:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,r.jsx)(l.default,{href:"/admin/products/".concat(e.id),className:"p-2 text-gray-400 hover:text-primary",children:(0,r.jsx)(p,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:()=>O({open:!0,product:e}),className:"p-2 text-gray-400 hover:text-error",children:(0,r.jsx)(x.Z,{className:"h-4 w-4"})})]})})]},e.id)}):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:"No products found"})})})]})})}),(0,r.jsx)(o.sm,{isOpen:E.open,onClose:()=>O({open:!1,product:null}),onConfirm:ee,title:"Delete Product",message:'Are you sure you want to delete "'.concat(null===(t=E.product)||void 0===t?void 0:t.name,'"? This action cannot be undone.'),confirmText:"Delete",variant:"danger",isLoading:_})]}):null}},8588:function(e,t,a){"use strict";a.d(t,{GJ:function(){return d},Zu:function(){return u}});let r="ROLE_ADMIN",n="ROLE_CONTENT_MANAGER",c="ROLE_SUPPORT_AGENT",s="ROLE_WAREHOUSE",l="ROLE_SUPER_ADMIN";function i(e,t){return e.includes(t)}function o(e,t){return t.some(t=>e.includes(t))}function d(e){return o(e,[r,n,c,s,l])}function u(e){return{canViewAdminProducts:o(e,[n,l]),canCreateProducts:o(e,[n,l]),canEditProducts:o(e,[n,l]),canDeleteProducts:o(e,[n,l]),canManageCategories:o(e,[n,l]),canPermanentDeleteCategories:i(e,l),canViewAllOrders:o(e,[s,n,c,l]),canFulfillOrders:o(e,[s,l]),canCancelOrders:o(e,[n,l]),canViewPayments:o(e,[c,n,l]),canProcessRefunds:o(e,[c,n,l]),canViewUsers:o(e,[r,c,l]),canManageRoles:i(e,l),canViewInventory:o(e,[s,n,l]),canAdjustInventory:o(e,[s,n,l]),canViewAnalytics:o(e,[r,l]),canExportData:i(e,l),canManageStorefront:o(e,[r,l]),canViewNotifications:o(e,[n,s,c,l]),canSendAnnouncements:o(e,[r,l]),canViewAuditLogs:i(e,l),isSuperAdmin:i(e,l)}}},5162:function(e,t,a){"use strict";a.d(t,{t:function(){return r.t},x:function(){return s}});var r=a(8488),n=a(3011),c=a(6305);let s=(0,n.U)((e,t)=>({cart:null,isLoading:!1,error:null,fetchCart:async()=>{e({isLoading:!0,error:null});try{let t=await c.x.get("/store/cart");e({cart:t.data.data})}catch(t){e({error:"Failed to load cart"})}finally{e({isLoading:!1})}},addItem:async(t,a,r)=>{e({isLoading:!0,error:null});try{let n=await c.x.post("/store/cart/items",{productId:t,quantity:a,selectedOptions:r});e({cart:n.data.data})}catch(t){var n,s,l;throw"INSUFFICIENT_STOCK"===(null===(l=t.response)||void 0===l?void 0:null===(s=l.data)||void 0===s?void 0:null===(n=s.data)||void 0===n?void 0:n.errorCode)?e({error:"Not enough stock available"}):e({error:"Failed to add item"}),t}finally{e({isLoading:!1})}},updateQuantity:async(a,r,n,s)=>{let l=t().cart,i=e=>n?e.itemKey===n:e.productId===a;l&&e({cart:{...l,items:l.items.map(e=>i(e)?{...e,quantity:r,subtotal:e.priceAtAdd*r}:e),totalAmount:l.items.reduce((e,t)=>i(t)?e+t.priceAtAdd*r:e+t.subtotal,0)}});try{let t=await c.x.put("/store/cart/items/".concat(a),{quantity:r,itemKey:n,selectedOptions:s});e({cart:t.data.data})}catch(t){throw e({cart:l,error:"Failed to update quantity"}),t}},removeItem:async(a,r)=>{let n=t().cart,s=e=>r?e.itemKey===r:e.productId===a;if(n){let t=n.items.filter(e=>!s(e));e({cart:{...n,items:t,itemCount:t.length,totalAmount:t.reduce((e,t)=>e+t.subtotal,0)}})}try{let t=r?"?itemKey=".concat(encodeURIComponent(r)):"",n=await c.x.delete("/store/cart/items/".concat(a).concat(t));e({cart:n.data.data})}catch(t){throw e({cart:n,error:"Failed to remove item"}),t}},clearCart:async()=>{try{await c.x.post("/store/cart/clear"),e({cart:null})}catch(t){throw e({error:"Failed to clear cart"}),t}},clearError:()=>e({error:null})}))}},function(e){e.O(0,[2972,6853,5878,9714,2971,2117,1744],function(){return e(e.s=8519)}),_N_E=e.O()}]);