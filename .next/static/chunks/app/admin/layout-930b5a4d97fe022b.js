(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9091],{2958:function(e,t,a){Promise.resolve().then(a.bind(a,6631))},6631:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return O}});var r=a(7437),n=a(2265),s=a(9376),i=a(7648),l=a(3145),c=a(5162),o=a(8588),d=a(6305),m=a(9714),u=a(5466),h=a(4794),f=a(4630),x=a(6275),p=a(7683),g=a(8226),y=a(5805),w=a(3113),b=a(6215),N=a(4766),v=a(3044),j=a(2489),A=a(8728),C=a(6840),E=a(875),k=a(7692),Z=a(7279);let S=[{href:"/admin",label:"Dashboard",icon:u.Z,permission:null},{href:"/admin/products",label:"Products",icon:h.Z,permission:"canViewAdminProducts"},{href:"/admin/categories",label:"Categories",icon:f.Z,permission:"canManageCategories"},{href:"/admin/orders",label:"Orders",icon:x.Z,permission:"canViewAllOrders"},{href:"/admin/inventory",label:"Inventory",icon:p.Z,permission:"canViewInventory"},{href:"/admin/payments",label:"Payments",icon:g.Z,permission:"canViewPayments"},{href:"/admin/customers",label:"Customers",icon:y.Z,permission:"canViewUsers"},{href:"/admin/storefront",label:"Storefront",icon:w.Z,permission:"canManageStorefront"},{href:"/admin/analytics",label:"Analytics",icon:b.Z,permission:"canViewAnalytics"},{href:"/admin/notifications",label:"Notifications",icon:N.Z,permission:"canViewNotifications"},{href:"/admin/audit-logs",label:"Audit Logs",icon:v.Z,permission:"canViewAuditLogs"}];function O(e){var t;let{children:a}=e,u=(0,s.useRouter)(),h=(0,s.usePathname)(),{isAuthenticated:f,isLoading:x,user:p,logout:g}=(0,c.t)(),[y,w]=(0,n.useState)(!1),[b,N]=(0,n.useState)(!1),[v,O]=(0,n.useState)(null);if((0,n.useEffect)(()=>{c.t.getState().checkAuth()},[]),(0,n.useEffect)(()=>{let e=async()=>{try{let e=await d.x.get("/admin/notifications/summary");O(e.data.data||null)}catch(e){O(null)}};f&&e()},[f]),(0,n.useEffect)(()=>{x||(f?p&&!(0,o.GJ)(p.roles)&&u.push("/"):u.push("/login?redirect=/admin"))},[x,f,p]),x)return(0,r.jsx)(m.AA,{});if(!f||!p||!(0,o.GJ)(p.roles))return null;let P=(0,o.Zu)(p.roles),V=S.filter(e=>!e.permission||P[e.permission]);return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[y&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>w(!1)}),(0,r.jsxs)("aside",{className:(0,Z.cn)("fixed top-0 left-0 z-50 h-full w-64 bg-primary text-white transform transition-transform duration-200 lg:translate-x-0",y?"translate-x-0":"-translate-x-full"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between h-16 px-4 border-b border-white/10",children:[(0,r.jsx)(i.default,{href:"/admin",className:"flex items-center",children:(0,r.jsx)(l.default,{src:"/logo.png",alt:"World Genius",width:120,height:32,className:"h-8 w-auto brightness-0 invert"})}),(0,r.jsx)("button",{onClick:()=>w(!1),className:"lg:hidden p-1",children:(0,r.jsx)(j.Z,{className:"h-5 w-5"})})]}),(0,r.jsx)("nav",{className:"p-4 space-y-1",children:V.map(e=>{let t=e.icon,a=h===e.href||"/admin"!==e.href&&h.startsWith(e.href),n="/admin/notifications"===e.href&&(null==v?void 0:v.totalUnread)||0;return(0,r.jsxs)(i.default,{href:e.href,onClick:()=>w(!1),className:(0,Z.cn)("flex items-center gap-3 px-3 py-2.5 rounded-lg transition-colors",a?"bg-white/20 text-white":"text-white/70 hover:bg-white/10 hover:text-white"),children:[(0,r.jsx)(t,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"flex-1",children:e.label}),n>0&&(0,r.jsx)("span",{className:"min-w-[20px] h-5 px-1.5 text-xs rounded-full bg-white text-primary flex items-center justify-center",children:n})]},e.href)})}),(0,r.jsx)("div",{className:"absolute bottom-0 left-0 right-0 p-4 border-t border-white/10",children:(0,r.jsxs)(i.default,{href:"/",className:"flex items-center gap-3 px-3 py-2 text-white/70 hover:text-white transition-colors",children:[(0,r.jsx)(A.Z,{className:"h-5 w-5"}),"Back to Store"]})})]}),(0,r.jsxs)("div",{className:"lg:ml-64",children:[(0,r.jsx)("header",{className:"sticky top-0 z-30 bg-white border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between h-16 px-4 lg:px-8",children:[(0,r.jsx)("button",{onClick:()=>w(!0),className:"lg:hidden p-2 text-gray-500 hover:text-primary",children:(0,r.jsx)(C.Z,{className:"h-6 w-6"})}),(0,r.jsx)("div",{className:"flex-1"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("button",{onClick:()=>N(!b),className:"flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-gray-100",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-primary text-white rounded-full flex items-center justify-center text-sm font-medium",children:(null===(t=p.fullName)||void 0===t?void 0:t.charAt(0))||"A"}),(0,r.jsx)("span",{className:"hidden sm:block text-sm font-medium text-gray-700",children:p.fullName}),(0,r.jsx)(E.Z,{className:"h-4 w-4 text-gray-400"})]}),b&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>N(!1)}),(0,r.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[(0,r.jsxs)("div",{className:"px-4 py-2 border-b border-gray-100",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900",children:p.fullName}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:p.email})]}),(0,r.jsx)(i.default,{href:"/account",className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",onClick:()=>N(!1),children:"Account Settings"}),(0,r.jsxs)("button",{onClick:()=>{g(),N(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-error hover:bg-gray-50",children:[(0,r.jsx)(k.Z,{className:"h-4 w-4 mr-2"}),"Sign out"]})]})]})]})]})}),(0,r.jsx)("main",{className:"p-4 sm:p-6 lg:p-8",children:a})]})]})}},8588:function(e,t,a){"use strict";a.d(t,{GJ:function(){return d},Zu:function(){return m}});let r="ROLE_ADMIN",n="ROLE_CONTENT_MANAGER",s="ROLE_SUPPORT_AGENT",i="ROLE_WAREHOUSE",l="ROLE_SUPER_ADMIN";function c(e,t){return e.includes(t)}function o(e,t){return t.some(t=>e.includes(t))}function d(e){return o(e,[r,n,s,i,l])}function m(e){return{canViewAdminProducts:o(e,[n,l]),canCreateProducts:o(e,[n,l]),canEditProducts:o(e,[n,l]),canDeleteProducts:o(e,[n,l]),canManageCategories:o(e,[n,l]),canPermanentDeleteCategories:c(e,l),canViewAllOrders:o(e,[i,n,s,l]),canFulfillOrders:o(e,[i,l]),canCancelOrders:o(e,[n,l]),canViewPayments:o(e,[s,n,l]),canProcessRefunds:o(e,[s,n,l]),canViewUsers:o(e,[r,s,l]),canManageRoles:c(e,l),canViewInventory:o(e,[i,n,l]),canAdjustInventory:o(e,[i,n,l]),canViewAnalytics:o(e,[r,l]),canExportData:c(e,l),canManageStorefront:o(e,[r,l]),canViewNotifications:o(e,[n,i,s,l]),canSendAnnouncements:o(e,[r,l]),canViewAuditLogs:c(e,l),isSuperAdmin:c(e,l)}}},5162:function(e,t,a){"use strict";a.d(t,{t:function(){return r.t},x:function(){return i}});var r=a(8488),n=a(3011),s=a(6305);let i=(0,n.U)((e,t)=>({cart:null,isLoading:!1,error:null,fetchCart:async()=>{e({isLoading:!0,error:null});try{let t=await s.x.get("/store/cart");e({cart:t.data.data})}catch(t){e({error:"Failed to load cart"})}finally{e({isLoading:!1})}},addItem:async(t,a,r)=>{e({isLoading:!0,error:null});try{let n=await s.x.post("/store/cart/items",{productId:t,quantity:a,selectedOptions:r});e({cart:n.data.data})}catch(t){var n,i,l;throw"INSUFFICIENT_STOCK"===(null===(l=t.response)||void 0===l?void 0:null===(i=l.data)||void 0===i?void 0:null===(n=i.data)||void 0===n?void 0:n.errorCode)?e({error:"Not enough stock available"}):e({error:"Failed to add item"}),t}finally{e({isLoading:!1})}},updateQuantity:async(a,r,n,i)=>{let l=t().cart,c=e=>n?e.itemKey===n:e.productId===a;l&&e({cart:{...l,items:l.items.map(e=>c(e)?{...e,quantity:r,subtotal:e.priceAtAdd*r}:e),totalAmount:l.items.reduce((e,t)=>c(t)?e+t.priceAtAdd*r:e+t.subtotal,0)}});try{let t=await s.x.put("/store/cart/items/".concat(a),{quantity:r,itemKey:n,selectedOptions:i});e({cart:t.data.data})}catch(t){throw e({cart:l,error:"Failed to update quantity"}),t}},removeItem:async(a,r)=>{let n=t().cart,i=e=>r?e.itemKey===r:e.productId===a;if(n){let t=n.items.filter(e=>!i(e));e({cart:{...n,items:t,itemCount:t.length,totalAmount:t.reduce((e,t)=>e+t.subtotal,0)}})}try{let t=r?"?itemKey=".concat(encodeURIComponent(r)):"",n=await s.x.delete("/store/cart/items/".concat(a).concat(t));e({cart:n.data.data})}catch(t){throw e({cart:n,error:"Failed to remove item"}),t}},clearCart:async()=>{try{await s.x.post("/store/cart/clear"),e({cart:null})}catch(t){throw e({error:"Failed to clear cart"}),t}},clearError:()=>e({error:null})}))}},function(e){e.O(0,[2972,6853,5878,4731,9714,2971,2117,1744],function(){return e(e.s=2958)}),_N_E=e.O()}]);