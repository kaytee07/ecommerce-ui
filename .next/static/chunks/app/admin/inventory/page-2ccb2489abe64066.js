(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3180],{2048:function(e,t,a){Promise.resolve().then(a.bind(a,6269))},875:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},9322:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},1671:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},8736:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},3245:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},1817:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},9554:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},4794:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},9397:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},3247:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},6275:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},6865:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},7689:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},2489:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},3145:function(e,t,a){"use strict";a.d(t,{default:function(){return n.a}});var r=a(8461),n=a.n(r)},7648:function(e,t,a){"use strict";a.d(t,{default:function(){return n.a}});var r=a(2972),n=a.n(r)},9376:function(e,t,a){"use strict";var r=a(5475);a.o(r,"notFound")&&a.d(t,{notFound:function(){return r.notFound}}),a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},8461:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{default:function(){return o},getImageProps:function(){return i}});let r=a(7043),n=a(5346),s=a(5878),c=r._(a(5084));function i(e){let{props:t}=(0,n.getImgProps)(e,{defaultLoader:c.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,a]of Object.entries(t))void 0===a&&delete t[e];return{props:t}}let o=s.Image},6269:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var r=a(7437),n=a(2265),s=a(9376),c=a(6305),i=a(9714),o=a(3247),l=a(6865),d=a(9554),u=a(9397),m=a(7279),p=a(5162),x=a(8588);function y(){var e,t;let a="true"===(0,s.useSearchParams)().get("lowStock"),y=(0,s.useRouter)(),{user:h}=(0,p.t)(),f=(0,n.useMemo)(()=>h?(0,x.Zu)(h.roles):null,[null==h?void 0:null===(e=h.roles)||void 0===e?void 0:e.join("|")]),g=(0,n.useRef)(null),[v,j]=(0,n.useState)([]),[k,N]=(0,n.useState)({}),[b,w]=(0,n.useState)(!0),[S,A]=(0,n.useState)(""),[I,C]=(0,n.useState)(a),[Z,E]=(0,n.useState)({open:!1,item:null}),[M,R]=(0,n.useState)({amount:0,reason:"",adjustmentType:"ADJUSTMENT"}),[P,L]=(0,n.useState)(!1),T=(0,n.useRef)(!1),O=(0,n.useCallback)(async()=>{w(!0);try{let e=I?"/admin/inventory/low-stock":"/admin/inventory",t=await c.x.get(e);j(t.data.data||[])}catch(e){console.error("Failed to fetch inventory",e),j([])}finally{w(!1)}},[I]),_=(0,n.useCallback)(async()=>{if(!T.current)try{var e;let t=new URLSearchParams;t.set("size","1000");let a=await c.x.get("/admin/products?".concat(t.toString())),r=(null===(e=a.data.data)||void 0===e?void 0:e.content)||a.data.data||[],n={};r.forEach(e=>{(null==e?void 0:e.id)&&(n[e.id]={name:e.name,sku:e.sku})}),N(n),T.current=!0}catch(e){console.error("Failed to fetch product info for inventory",e)}},[]);(0,n.useEffect)(()=>{if(!h)return;if(!(null==f?void 0:f.canViewInventory)){y.push("/admin");return}let e="".concat(h.id||h.username||"user",":").concat(I?"low":"all");g.current!==e&&(g.current=e,O())},[I,h,null==f?void 0:f.canViewInventory,y,O]),(0,n.useEffect)(()=>{0!==v.length&&v.some(e=>!k[e.productId])&&_()},[v,k,_]);let z=async()=>{if(Z.item&&M.reason&&(null==f?void 0:f.canAdjustInventory)){L(!0);try{await c.x.post("/admin/inventory/".concat(Z.item.productId,"/adjust"),{quantity:M.amount,adjustmentType:M.adjustmentType,reason:M.reason}),await O(),E({open:!1,item:null}),R({amount:0,reason:"",adjustmentType:"ADJUSTMENT"})}catch(e){console.error("Failed to adjust inventory",e)}finally{L(!1)}}},V=(v||[]).filter(e=>{let t=S.toLowerCase(),a=k[e.productId];return(e.productId||"").toLowerCase().includes(t)||(e.productName||(null==a?void 0:a.name)||"").toLowerCase().includes(t)||(e.sku||(null==a?void 0:a.sku)||"").toLowerCase().includes(t)});return!h||(null==f?void 0:f.canViewInventory)?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Inventory"})}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)("input",{type:"search",placeholder:"Search by product or SKU...",value:S,onChange:e=>A(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:border-primary focus:ring-1 focus:ring-primary"}),(0,r.jsx)(o.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"})]}),(0,r.jsxs)("label",{className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[(0,r.jsx)("input",{type:"checkbox",checked:I,onChange:e=>C(e.target.checked),className:"h-4 w-4 text-primary border-gray-300 rounded focus:ring-primary"}),(0,r.jsx)(l.Z,{className:"h-4 w-4 text-warning"}),(0,r.jsx)("span",{className:"text-sm",children:"Low stock only"})]})]}),(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"In Stock"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reserved"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Available"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-gray-200",children:b?Array.from({length:5}).map((e,t)=>(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:6,className:"px-6 py-4",children:(0,r.jsx)(i.Od,{className:"h-12 w-full"})})},t)):0===V.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:I?"No low stock items found":"No inventory records found"})}):V.map(e=>{var t,a;let n=e.availableQuantity<=5,s=e.availableQuantity<=0;return(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsxs)("td",{className:"px-6 py-4",children:[(0,r.jsx)("div",{className:"text-sm text-gray-900",children:e.productName||(null===(t=k[e.productId])||void 0===t?void 0:t.name)||e.productId}),(0,r.jsx)("div",{className:"text-xs text-gray-500 font-mono",children:e.sku||(null===(a=k[e.productId])||void 0===a?void 0:a.sku)||"â€”"})]}),(0,r.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:e.stockQuantity}),(0,r.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:e.reservedQuantity}),(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsx)("span",{className:(0,m.cn)("font-medium",s?"text-error":n?"text-warning":"text-gray-900"),children:e.availableQuantity})}),(0,r.jsx)("td",{className:"px-6 py-4",children:s?(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-error-bg text-error",children:"Out of Stock"}):n?(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-warning-bg text-warning",children:"Low Stock"}):(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-success-bg text-success",children:"In Stock"})}),(0,r.jsx)("td",{className:"px-6 py-4 text-right",children:(0,r.jsx)(i.zx,{variant:"outline",size:"sm",onClick:()=>{(null==f?void 0:f.canAdjustInventory)&&(E({open:!0,item:e}),R({amount:0,reason:"",adjustmentType:"ADJUSTMENT"}))},disabled:!(null==f?void 0:f.canAdjustInventory),children:"Adjust"})})]},e.id)})})]})})}),(0,r.jsx)(i.u_,{isOpen:Z.open,onClose:()=>E({open:!1,item:null}),title:"Adjust Stock",size:"sm",children:Z.item&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Product"}),(0,r.jsx)("p",{className:"font-medium",children:Z.item.productName||(null===(t=k[Z.item.productId])||void 0===t?void 0:t.name)||Z.item.productId})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Current Stock"}),(0,r.jsx)("p",{className:"font-medium",children:Z.item.stockQuantity})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Adjustment"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{type:"button",onClick:()=>R(e=>({...e,amount:e.amount-1})),className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:(0,r.jsx)(d.Z,{className:"h-4 w-4"})}),(0,r.jsx)("input",{type:"number",value:M.amount,onChange:e=>R(t=>({...t,amount:parseInt(e.target.value)||0})),className:"w-24 px-3 py-2 border border-gray-300 rounded-lg text-center focus:border-primary focus:ring-1 focus:ring-primary"}),(0,r.jsx)("button",{type:"button",onClick:()=>R(e=>({...e,amount:e.amount+1})),className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:(0,r.jsx)(u.Z,{className:"h-4 w-4"})})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["New stock: ",Z.item.stockQuantity+M.amount]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Adjustment Type"}),(0,r.jsxs)("select",{value:M.adjustmentType,onChange:e=>R(t=>({...t,adjustmentType:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:border-primary focus:ring-1 focus:ring-primary",children:[(0,r.jsx)("option",{value:"ADJUSTMENT",children:"Adjustment"}),(0,r.jsx)("option",{value:"RESTOCK",children:"Restock"}),(0,r.jsx)("option",{value:"SALE",children:"Sale"}),(0,r.jsx)("option",{value:"RESERVE",children:"Reserve"}),(0,r.jsx)("option",{value:"RELEASE",children:"Release"})]})]}),(0,r.jsx)(i.II,{label:"Reason (required)",placeholder:"e.g., Restock from supplier",value:M.reason,onChange:e=>R(t=>({...t,reason:e.target.value}))}),(0,r.jsxs)("div",{className:"flex gap-3 justify-end pt-4",children:[(0,r.jsx)(i.zx,{variant:"outline",onClick:()=>E({open:!1,item:null}),children:"Cancel"}),(0,r.jsx)(i.zx,{onClick:z,disabled:0===M.amount||!M.reason,isLoading:P,children:"Apply Adjustment"})]})]})})]}):null}function h(){return(0,r.jsx)(n.Suspense,{fallback:(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsx)(i.Od,{className:"h-96 w-full"})}),children:(0,r.jsx)(y,{})})}},8588:function(e,t,a){"use strict";a.d(t,{GJ:function(){return d},Zu:function(){return u}});let r="ROLE_ADMIN",n="ROLE_CONTENT_MANAGER",s="ROLE_SUPPORT_AGENT",c="ROLE_WAREHOUSE",i="ROLE_SUPER_ADMIN";function o(e,t){return e.includes(t)}function l(e,t){return t.some(t=>e.includes(t))}function d(e){return l(e,[r,n,s,c,i])}function u(e){return{canViewAdminProducts:l(e,[n,i]),canCreateProducts:l(e,[n,i]),canEditProducts:l(e,[n,i]),canDeleteProducts:l(e,[n,i]),canManageCategories:l(e,[n,i]),canPermanentDeleteCategories:o(e,i),canViewAllOrders:l(e,[c,n,s,i]),canFulfillOrders:l(e,[c,i]),canCancelOrders:l(e,[n,i]),canViewPayments:l(e,[s,n,i]),canProcessRefunds:l(e,[s,n,i]),canViewUsers:l(e,[r,s,i]),canManageRoles:o(e,i),canViewInventory:l(e,[c,n,i]),canAdjustInventory:l(e,[c,n,i]),canViewAnalytics:l(e,[r,i]),canExportData:o(e,i),canManageStorefront:l(e,[r,i]),canViewNotifications:l(e,[n,c,s,i]),canSendAnnouncements:l(e,[r,i]),canViewAuditLogs:o(e,i),isSuperAdmin:o(e,i)}}},5162:function(e,t,a){"use strict";a.d(t,{t:function(){return r.t},x:function(){return c}});var r=a(8488),n=a(3011),s=a(6305);let c=(0,n.U)((e,t)=>({cart:null,isLoading:!1,error:null,fetchCart:async()=>{e({isLoading:!0,error:null});try{let t=await s.x.get("/store/cart");e({cart:t.data.data})}catch(t){e({error:"Failed to load cart"})}finally{e({isLoading:!1})}},addItem:async(t,a,r)=>{e({isLoading:!0,error:null});try{let n=await s.x.post("/store/cart/items",{productId:t,quantity:a,selectedOptions:r});e({cart:n.data.data})}catch(t){var n,c,i;throw"INSUFFICIENT_STOCK"===(null===(i=t.response)||void 0===i?void 0:null===(c=i.data)||void 0===c?void 0:null===(n=c.data)||void 0===n?void 0:n.errorCode)?e({error:"Not enough stock available"}):e({error:"Failed to add item"}),t}finally{e({isLoading:!1})}},updateQuantity:async(a,r,n,c)=>{let i=t().cart,o=e=>n?e.itemKey===n:e.productId===a;i&&e({cart:{...i,items:i.items.map(e=>o(e)?{...e,quantity:r,subtotal:e.priceAtAdd*r}:e),totalAmount:i.items.reduce((e,t)=>o(t)?e+t.priceAtAdd*r:e+t.subtotal,0)}});try{let t=await s.x.put("/store/cart/items/".concat(a),{quantity:r,itemKey:n,selectedOptions:c});e({cart:t.data.data})}catch(t){throw e({cart:i,error:"Failed to update quantity"}),t}},removeItem:async(a,r)=>{let n=t().cart,c=e=>r?e.itemKey===r:e.productId===a;if(n){let t=n.items.filter(e=>!c(e));e({cart:{...n,items:t,itemCount:t.length,totalAmount:t.reduce((e,t)=>e+t.subtotal,0)}})}try{let t=r?"?itemKey=".concat(encodeURIComponent(r)):"",n=await s.x.delete("/store/cart/items/".concat(a).concat(t));e({cart:n.data.data})}catch(t){throw e({cart:n,error:"Failed to remove item"}),t}},clearCart:async()=>{try{await s.x.post("/store/cart/clear"),e({cart:null})}catch(t){throw e({error:"Failed to clear cart"}),t}},clearError:()=>e({error:null})}))}},function(e){e.O(0,[2972,6853,5878,9714,2971,2117,1744],function(){return e(e.s=2048)}),_N_E=e.O()}]);