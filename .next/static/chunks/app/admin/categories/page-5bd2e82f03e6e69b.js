(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4331],{107:function(e,t,a){Promise.resolve().then(a.bind(a,3440))},407:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},4630:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("folder-tree",[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]])},3113:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},9397:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},8930:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},9376:function(e,t,a){"use strict";var r=a(5475);a.o(r,"notFound")&&a.d(t,{notFound:function(){return r.notFound}}),a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},3440:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return P}});var r=a(7437),s=a(2265),l=a(9376),n=a(9501),i=a(5701),c=a(7119),d=a(3145),o=a(6305),u=a(9714),m=a(9397),x=a(3247),g=a(2489),p=a(1817),h=a(3113),y=a(4630),f=a(875),v=a(407),b=a(9205);let j=(0,b.Z)("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),N=(0,b.Z)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var w=a(8930),k=a(7279),C=a(5162),S=a(8588);let A=c.Ry({name:c.Z_().min(1,"Name is required").max(100),slug:c.Z_().regex(/^[a-z0-9-]*$/,"Only lowercase letters, numbers, and hyphens").optional(),description:c.Z_().max(500).optional(),parentId:c.Z_().nullable().optional(),displayOrder:c.Rx().int().min(0).default(0),active:c.O7().default(!0)});function P(){var e;let t=(0,l.useRouter)(),{user:a}=(0,C.t)(),c=(0,s.useMemo)(()=>a?(0,S.Zu)(a.roles):null,[null==a?void 0:null===(e=a.roles)||void 0===e?void 0:e.join("|")]),f=(0,s.useRef)(null),[v,b]=(0,s.useState)([]),[j,N]=(0,s.useState)(!0),[w,k]=(0,s.useState)(!1),[P,M]=(0,s.useState)(null),[I,F]=(0,s.useState)(new Set),[E,O]=(0,s.useState)(""),[R,_]=(0,s.useState)(null),[L,U]=(0,s.useState)(null),[D,z]=(0,s.useState)(null),[V,T]=(0,s.useState)(!1),[G,K]=(0,s.useState)(null),[q,H]=(0,s.useState)(null),J=(0,s.useRef)(null),W=(0,s.useMemo)(()=>{let e=new Map,t=new Map;v.forEach(a=>{if(e.set(a.id,a),a.parentId){let e=t.get(a.parentId)||[];e.push(a),t.set(a.parentId,e)}});let a=new Map,r=s=>{if(a.has(s))return a.get(s);let l=e.get(s),n=(null==l?void 0:l.productCount)||0;return(t.get(s)||[]).forEach(e=>{n+=r(e.id)}),a.set(s,n),n};return v.forEach(e=>r(e.id)),a},[v]),{register:B,handleSubmit:$,reset:Q,setValue:X,formState:{errors:Y,isSubmitting:ee}}=(0,n.cI)({resolver:(0,i.F)(A),defaultValues:{displayOrder:0,active:!0}}),et=(0,s.useCallback)(async()=>{N(!0);try{let e=await o.x.get("/admin/categories");b(e.data.data||[])}catch(e){console.error("Failed to fetch categories",e),b([])}finally{N(!1)}},[]);(0,s.useEffect)(()=>{if(!a)return;if(!(null==c?void 0:c.canManageCategories)){t.push("/admin");return}let e="".concat(a.id||a.username||"user");f.current!==e&&(f.current=e,et())},[a,null==c?void 0:c.canManageCategories,t,et]);let ea=async e=>{var t,a,r,s,l,n;H(null);try{if(P){let r=await o.x.put("/admin/categories/".concat(P.id),e),s=null===(t=r.data.data)||void 0===t?void 0:t.category,l=(null==s?void 0:s.imageUrl)||P.imageUrl||null;if(D){T(!0);try{let e=new FormData;e.append("file",D);let t=await o.x.post("/admin/categories/".concat(P.id,"/image"),e,{headers:{"Content-Type":"multipart/form-data"}});l=(null===(a=t.data.data)||void 0===a?void 0:a.imageUrl)||l}catch(e){console.error("Failed to upload category image",e),H("Category updated, but image upload failed. Please try again.")}finally{T(!1)}}b(t=>t.map(t=>t.id===P.id?{...t,...s||e,imageUrl:l,slug:e.slug||er(e.name)}:t))}else{let t=await o.x.post("/admin/categories",e),a=null===(r=t.data.data)||void 0===r?void 0:r.category;if(a){let e=a.imageUrl||null;if(D){T(!0);try{let t=new FormData;t.append("file",D);let r=await o.x.post("/admin/categories/".concat(a.id,"/image"),t,{headers:{"Content-Type":"multipart/form-data"}});e=(null===(s=r.data.data)||void 0===s?void 0:s.imageUrl)||e}catch(e){console.error("Failed to upload category image",e),H("Category created, but image upload failed. Please try again.")}finally{T(!1)}}b(t=>[...t,{...a,imageUrl:e}])}}ec()}catch(e){console.error("Failed to save category",e),H((null===(n=e.response)||void 0===n?void 0:null===(l=n.data)||void 0===l?void 0:l.message)||"Failed to save category. Please try again.")}},er=e=>e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""),es=async e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;if(!["image/jpeg","image/png","image/webp"].includes(a.type)){K("Invalid file type. Please upload JPG, PNG, or WebP.");return}if(a.size>5242880){K("File too large. Maximum size is 5MB.");return}K(null),z(a);let r=new FileReader;r.onload=()=>{U(r.result)},r.readAsDataURL(a),J.current&&(J.current.value="")},el=e=>{M(e),X("name",e.name),X("slug",e.slug),X("description",e.description||""),X("parentId",e.parentId||null),X("displayOrder",e.displayOrder),X("active",e.active),U(e.imageUrl||null),z(null),K(null),k(!0)},en=async e=>{if(confirm("Are you sure you want to delete this category?")){_(e),H(null);try{await o.x.delete("/admin/categories/".concat(e)),b(t=>t.filter(t=>t.id!==e))}catch(e){var t,a;console.error("Failed to delete category",e),H((null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.message)||"Failed to delete category.")}finally{_(null)}}},ei=async e=>{H(null);try{e.active?await o.x.delete("/admin/categories/".concat(e.id)):await o.x.post("/admin/categories/".concat(e.id,"/activate")),b(t=>t.map(t=>t.id===e.id?{...t,active:!t.active}:t))}catch(e){var t,a;console.error("Failed to toggle category status",e),H((null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.message)||"Failed to update category status.")}},ec=()=>{k(!1),M(null),U(null),z(null),K(null),Q()},ed=e=>{let t=new Set(I);t.has(e)?t.delete(e):t.add(e),F(t)},eo=v.filter(e=>e.name.toLowerCase().includes(E.toLowerCase())),eu=eo.filter(e=>!e.parentId);return j?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(u.Od,{className:"h-10 w-64"}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,r.jsx)(u.Od,{className:"h-8 w-full mb-4"}),[1,2,3,4,5].map(e=>(0,r.jsx)(u.Od,{className:"h-16 w-full mb-2"},e))]})]}):!a||(null==c?void 0:c.canManageCategories)?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Categories"}),(0,r.jsxs)(u.zx,{onClick:()=>k(!0),children:[(0,r.jsx)(m.Z,{className:"h-4 w-4 mr-2"}),"Add Category"]})]}),q&&(0,r.jsx)("div",{className:"rounded-lg border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",children:q}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(x.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,r.jsx)("input",{type:"text",placeholder:"Search categories...",value:E,onChange:e=>O(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"})]}),w&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 flex-shrink-0",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:P?"Edit Category":"Add Category"}),(0,r.jsx)("button",{onClick:ec,className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)(g.Z,{className:"h-5 w-5"})})]}),(0,r.jsxs)("form",{onSubmit:$(ea),className:"flex-1 overflow-y-auto p-6 space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),(0,r.jsx)("input",{...B("name"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"}),Y.name&&(0,r.jsx)("p",{className:"text-sm text-error mt-1",children:Y.name.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Slug (auto-generated if empty)"}),(0,r.jsx)("input",{...B("slug"),placeholder:"e.g., electronics, clothing",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"}),Y.slug&&(0,r.jsx)("p",{className:"text-sm text-error mt-1",children:Y.slug.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,r.jsx)("textarea",{...B("description"),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent resize-none"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Image (Optional)"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:"Used for storefront category display. JPG, PNG, or WebP up to 5MB."}),L?(0,r.jsxs)("div",{className:"relative w-32 h-32",children:[(0,r.jsx)(d.default,{src:L,alt:"Category image",fill:!0,className:"object-cover rounded-lg border border-gray-200"}),V&&(0,r.jsx)("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center rounded-lg",children:(0,r.jsx)(p.Z,{className:"h-6 w-6 text-white animate-spin"})}),!V&&(0,r.jsx)("button",{type:"button",onClick:()=>{U(null),z(null),K(null)},className:"absolute -top-2 -right-2 p-1 bg-white rounded-full shadow-md hover:bg-gray-100 transition-colors border border-gray-200",children:(0,r.jsx)(g.Z,{className:"h-4 w-4 text-gray-600"})})]}):(0,r.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=J.current)||void 0===e?void 0:e.click()},disabled:V,className:"w-32 h-32 border-2 border-dashed border-gray-300 rounded-lg hover:border-primary transition-colors flex flex-col items-center justify-center",children:V?(0,r.jsx)(p.Z,{className:"h-6 w-6 text-primary animate-spin"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.Z,{className:"h-8 w-8 text-gray-400 mb-1"}),(0,r.jsx)("span",{className:"text-xs text-gray-500",children:"Add Image"})]})}),(0,r.jsx)("input",{ref:J,type:"file",accept:"image/jpeg,image/png,image/webp",onChange:es,disabled:V,className:"hidden"}),G&&(0,r.jsx)("p",{className:"text-sm text-error mt-2",children:G})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Parent Category"}),(0,r.jsxs)("select",{...B("parentId"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",children:[(0,r.jsx)("option",{value:"",children:"None (Root Category)"}),v.filter(e=>e.id!==(null==P?void 0:P.id)).map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Order"}),(0,r.jsx)("input",{type:"number",...B("displayOrder",{valueAsNumber:!0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"checkbox",...B("active"),id:"active",className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),(0,r.jsx)("label",{htmlFor:"active",className:"text-sm text-gray-700",children:"Active"})]}),(0,r.jsxs)("div",{className:"flex gap-3 pt-4 border-t border-gray-200 mt-4",children:[(0,r.jsx)(u.zx,{type:"button",variant:"outline",onClick:ec,className:"flex-1",children:"Cancel"}),(0,r.jsx)(u.zx,{type:"submit",disabled:ee,className:"flex-1",children:ee?"Saving...":P?"Update":"Create"})]})]})]})}),(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"text-left px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),(0,r.jsx)("th",{className:"text-left px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Slug"}),(0,r.jsx)("th",{className:"text-center px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Products"}),(0,r.jsx)("th",{className:"text-center px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"text-right px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-gray-200",children:0===eu.length?(0,r.jsx)("tr",{children:(0,r.jsxs)("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-500",children:[(0,r.jsx)(y.Z,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,r.jsx)("p",{children:"No categories found"})]})}):eu.map(e=>(0,r.jsx)(Z,{category:e,allCategories:eo,level:0,expandedIds:I,toggleExpand:ed,onEdit:el,onDelete:en,onToggleActive:ei,deletingId:R,productCountMap:W},e.id))})]})})})]}):null}function Z(e){var t,a;let{category:l,allCategories:n,level:i,expandedIds:c,toggleExpand:o,onEdit:u,onDelete:m,onToggleActive:x,deletingId:g,productCountMap:p}=e,h=n.filter(e=>e.parentId===l.id),b=h.length>0,C=c.has(l.id),[S,A]=(0,s.useState)(!1),P=null!==(a=null!==(t=p.get(l.id))&&void 0!==t?t:l.productCount)&&void 0!==a?a:0;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("tr",{className:(0,k.cn)(!l.active&&"bg-gray-50 text-gray-400"),children:[(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center",style:{paddingLeft:"".concat(24*i,"px")},children:[b?(0,r.jsx)("button",{onClick:()=>o(l.id),className:"p-1 hover:bg-gray-100 rounded mr-2",children:C?(0,r.jsx)(f.Z,{className:"h-4 w-4"}):(0,r.jsx)(v.Z,{className:"h-4 w-4"})}):(0,r.jsx)("span",{className:"w-6 mr-2"}),l.imageUrl?(0,r.jsx)("div",{className:"relative w-8 h-8 mr-3 flex-shrink-0",children:(0,r.jsx)(d.default,{src:l.imageUrl,alt:l.name,fill:!0,className:"object-cover rounded"})}):(0,r.jsx)(y.Z,{className:"h-5 w-5 text-gray-400 mr-3 flex-shrink-0"}),(0,r.jsx)("span",{className:"font-medium",children:l.name})]})}),(0,r.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500 font-mono",children:l.slug}),(0,r.jsx)("td",{className:"px-6 py-4 text-center text-sm",children:P}),(0,r.jsx)("td",{className:"px-6 py-4 text-center",children:(0,r.jsx)("span",{className:(0,k.cn)("px-2 py-1 text-xs rounded-full",l.active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"),children:l.active?"Active":"Inactive"})}),(0,r.jsx)("td",{className:"px-6 py-4 text-right",children:(0,r.jsxs)("div",{className:"relative inline-block",children:[(0,r.jsx)("button",{onClick:()=>A(!S),className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,r.jsx)(j,{className:"h-4 w-4"})}),S&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>A(!1)}),(0,r.jsxs)("div",{className:"absolute right-0 mt-1 w-40 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[(0,r.jsxs)("button",{onClick:()=>{u(l),A(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[(0,r.jsx)(N,{className:"h-4 w-4 mr-2"}),"Edit"]}),(0,r.jsx)("button",{onClick:()=>{x(l),A(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:l.active?"Deactivate":"Activate"}),(0,r.jsxs)("button",{onClick:()=>{m(l.id),A(!1)},disabled:g===l.id,className:"flex items-center w-full px-4 py-2 text-sm text-error hover:bg-gray-50 disabled:opacity-50",children:[(0,r.jsx)(w.Z,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})})]}),C&&h.map(e=>(0,r.jsx)(Z,{category:e,allCategories:n,level:i+1,expandedIds:c,toggleExpand:o,onEdit:u,onDelete:m,onToggleActive:x,deletingId:g,productCountMap:p},e.id))]})}},8588:function(e,t,a){"use strict";a.d(t,{GJ:function(){return o},Zu:function(){return u}});let r="ROLE_ADMIN",s="ROLE_CONTENT_MANAGER",l="ROLE_SUPPORT_AGENT",n="ROLE_WAREHOUSE",i="ROLE_SUPER_ADMIN";function c(e,t){return e.includes(t)}function d(e,t){return t.some(t=>e.includes(t))}function o(e){return d(e,[r,s,l,n,i])}function u(e){return{canViewAdminProducts:d(e,[s,i]),canCreateProducts:d(e,[s,i]),canEditProducts:d(e,[s,i]),canDeleteProducts:d(e,[s,i]),canManageCategories:d(e,[s,i]),canPermanentDeleteCategories:c(e,i),canViewAllOrders:d(e,[n,s,l,i]),canFulfillOrders:d(e,[n,i]),canCancelOrders:d(e,[s,i]),canViewPayments:d(e,[l,s,i]),canProcessRefunds:d(e,[l,s,i]),canViewUsers:d(e,[r,l,i]),canManageRoles:c(e,i),canViewInventory:d(e,[n,s,i]),canAdjustInventory:d(e,[n,s,i]),canViewAnalytics:d(e,[r,i]),canExportData:c(e,i),canManageStorefront:d(e,[r,i]),canViewNotifications:d(e,[s,n,l,i]),canSendAnnouncements:d(e,[r,i]),canViewAuditLogs:c(e,i),isSuperAdmin:c(e,i)}}},5162:function(e,t,a){"use strict";a.d(t,{t:function(){return r.t},x:function(){return n}});var r=a(8488),s=a(3011),l=a(6305);let n=(0,s.U)((e,t)=>({cart:null,isLoading:!1,error:null,fetchCart:async()=>{e({isLoading:!0,error:null});try{let t=await l.x.get("/store/cart");e({cart:t.data.data})}catch(t){e({error:"Failed to load cart"})}finally{e({isLoading:!1})}},addItem:async(t,a,r)=>{e({isLoading:!0,error:null});try{let s=await l.x.post("/store/cart/items",{productId:t,quantity:a,selectedOptions:r});e({cart:s.data.data})}catch(t){var s,n,i;throw"INSUFFICIENT_STOCK"===(null===(i=t.response)||void 0===i?void 0:null===(n=i.data)||void 0===n?void 0:null===(s=n.data)||void 0===s?void 0:s.errorCode)?e({error:"Not enough stock available"}):e({error:"Failed to add item"}),t}finally{e({isLoading:!1})}},updateQuantity:async(a,r,s,n)=>{let i=t().cart,c=e=>s?e.itemKey===s:e.productId===a;i&&e({cart:{...i,items:i.items.map(e=>c(e)?{...e,quantity:r,subtotal:e.priceAtAdd*r}:e),totalAmount:i.items.reduce((e,t)=>c(t)?e+t.priceAtAdd*r:e+t.subtotal,0)}});try{let t=await l.x.put("/store/cart/items/".concat(a),{quantity:r,itemKey:s,selectedOptions:n});e({cart:t.data.data})}catch(t){throw e({cart:i,error:"Failed to update quantity"}),t}},removeItem:async(a,r)=>{let s=t().cart,n=e=>r?e.itemKey===r:e.productId===a;if(s){let t=s.items.filter(e=>!n(e));e({cart:{...s,items:t,itemCount:t.length,totalAmount:t.reduce((e,t)=>e+t.subtotal,0)}})}try{let t=r?"?itemKey=".concat(encodeURIComponent(r)):"",s=await l.x.delete("/store/cart/items/".concat(a).concat(t));e({cart:s.data.data})}catch(t){throw e({cart:s,error:"Failed to remove item"}),t}},clearCart:async()=>{try{await l.x.post("/store/cart/clear"),e({cart:null})}catch(t){throw e({error:"Failed to clear cart"}),t}},clearError:()=>e({error:null})}))}},function(e){e.O(0,[2972,6853,5878,2428,6572,9714,2971,2117,1744],function(){return e(e.s=107)}),_N_E=e.O()}]);