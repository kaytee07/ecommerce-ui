(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7017],{4274:function(e,r,a){Promise.resolve().then(a.bind(a,8246))},8246:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return c}});var t=a(7437),s=a(2265),o=a(9501),d=a(5162),l=a(6305),i=a(9714),n=a(1917);function c(){var e,r,a,c;let{user:u,setUser:m}=(0,d.t)(),w=(0,n.p)(),[h,p]=(0,s.useState)(!1),[f,g]=(0,s.useState)(!1),y=(0,o.cI)({defaultValues:{fullName:(null==u?void 0:u.fullName)||"",email:(null==u?void 0:u.email)||""}}),x=(0,o.cI)(),v=async e=>{p(!0);try{let r=await l.x.put("/users/".concat(null==u?void 0:u.id),e);m(r.data.data),w.success("Profile updated successfully")}catch(e){w.error("Failed to update profile")}finally{p(!1)}},b=async e=>{if(e.newPassword!==e.confirmPassword){x.setError("confirmPassword",{message:"Passwords do not match"});return}g(!0);try{await l.x.post("/auth/change-password",{currentPassword:e.currentPassword,newPassword:e.newPassword});let r=await l.x.get("/auth/me");m(r.data.data),x.reset(),w.success("Password updated successfully")}catch(e){var r,a;w.error((null===(a=e.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.message)||"Failed to update password")}finally{g(!1)}};return(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Account Settings"}),(null==u?void 0:u.mustChangePassword)&&(0,t.jsx)("div",{className:"p-4 bg-yellow-50 text-yellow-800 rounded-lg",children:"You must change your password before continuing to other areas of the app."}),(0,t.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,t.jsx)("h2",{className:"font-semibold text-gray-900 mb-6",children:"Profile Information"}),(0,t.jsxs)("form",{onSubmit:y.handleSubmit(v),className:"space-y-4 max-w-md",children:[(0,t.jsx)(i.II,{label:"Full Name",...y.register("fullName",{required:"Name is required"}),error:null===(e=y.formState.errors.fullName)||void 0===e?void 0:e.message}),(0,t.jsx)(i.II,{label:"Email",type:"email",disabled:!0,className:"bg-gray-50",...y.register("email")}),(0,t.jsx)("p",{className:"text-xs text-gray-500 -mt-2",children:"Email cannot be changed"}),(0,t.jsx)(i.zx,{type:"submit",isLoading:h,children:"Save Changes"})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,t.jsx)("h2",{className:"font-semibold text-gray-900 mb-6",children:"Change Password"}),(0,t.jsxs)("form",{onSubmit:x.handleSubmit(b),className:"space-y-4 max-w-md",children:[(0,t.jsx)(i.II,{label:"Current Password",type:"password",...x.register("currentPassword",{required:"Current password is required"}),error:null===(r=x.formState.errors.currentPassword)||void 0===r?void 0:r.message}),(0,t.jsx)(i.II,{label:"New Password",type:"password",...x.register("newPassword",{required:"New password is required",minLength:{value:8,message:"Password must be at least 8 characters"}}),error:null===(a=x.formState.errors.newPassword)||void 0===a?void 0:a.message}),(0,t.jsx)(i.II,{label:"Confirm New Password",type:"password",...x.register("confirmPassword",{required:"Please confirm your password"}),error:null===(c=x.formState.errors.confirmPassword)||void 0===c?void 0:c.message}),(0,t.jsx)(i.zx,{type:"submit",isLoading:f,children:"Update Password"})]})]})]})}},5162:function(e,r,a){"use strict";a.d(r,{t:function(){return t.t},x:function(){return d}});var t=a(8488),s=a(3011),o=a(6305);let d=(0,s.U)((e,r)=>({cart:null,isLoading:!1,error:null,fetchCart:async()=>{e({isLoading:!0,error:null});try{let r=await o.x.get("/store/cart");e({cart:r.data.data})}catch(r){e({error:"Failed to load cart"})}finally{e({isLoading:!1})}},addItem:async(r,a,t)=>{e({isLoading:!0,error:null});try{let s=await o.x.post("/store/cart/items",{productId:r,quantity:a,selectedOptions:t});e({cart:s.data.data})}catch(r){var s,d,l;throw"INSUFFICIENT_STOCK"===(null===(l=r.response)||void 0===l?void 0:null===(d=l.data)||void 0===d?void 0:null===(s=d.data)||void 0===s?void 0:s.errorCode)?e({error:"Not enough stock available"}):e({error:"Failed to add item"}),r}finally{e({isLoading:!1})}},updateQuantity:async(a,t,s,d)=>{let l=r().cart,i=e=>s?e.itemKey===s:e.productId===a;l&&e({cart:{...l,items:l.items.map(e=>i(e)?{...e,quantity:t,subtotal:e.priceAtAdd*t}:e),totalAmount:l.items.reduce((e,r)=>i(r)?e+r.priceAtAdd*t:e+r.subtotal,0)}});try{let r=await o.x.put("/store/cart/items/".concat(a),{quantity:t,itemKey:s,selectedOptions:d});e({cart:r.data.data})}catch(r){throw e({cart:l,error:"Failed to update quantity"}),r}},removeItem:async(a,t)=>{let s=r().cart,d=e=>t?e.itemKey===t:e.productId===a;if(s){let r=s.items.filter(e=>!d(e));e({cart:{...s,items:r,itemCount:r.length,totalAmount:r.reduce((e,r)=>e+r.subtotal,0)}})}try{let r=t?"?itemKey=".concat(encodeURIComponent(t)):"",s=await o.x.delete("/store/cart/items/".concat(a).concat(r));e({cart:s.data.data})}catch(r){throw e({cart:s,error:"Failed to remove item"}),r}},clearCart:async()=>{try{await o.x.post("/store/cart/clear"),e({cart:null})}catch(r){throw e({error:"Failed to clear cart"}),r}},clearError:()=>e({error:null})}))}},function(e){e.O(0,[2972,6853,5878,2428,9714,2971,2117,1744],function(){return e(e.s=4274)}),_N_E=e.O()}]);