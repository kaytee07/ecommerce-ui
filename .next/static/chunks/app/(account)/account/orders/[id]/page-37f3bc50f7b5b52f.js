(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8574],{2102:function(e,t,s){Promise.resolve().then(s.bind(s,4368))},2660:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},875:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},9322:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},1671:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},9388:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},1723:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},8226:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},8736:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},3245:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},1817:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},4794:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},2636:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("refresh-ccw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]])},3247:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},6275:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},6865:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},7689:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},2489:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9205).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},3145:function(e,t,s){"use strict";s.d(t,{default:function(){return r.a}});var a=s(8461),r=s.n(a)},7648:function(e,t,s){"use strict";s.d(t,{default:function(){return r.a}});var a=s(2972),r=s.n(a)},9376:function(e,t,s){"use strict";var a=s(5475);s.o(a,"notFound")&&s.d(t,{notFound:function(){return a.notFound}}),s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},8461:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{default:function(){return l},getImageProps:function(){return c}});let a=s(7043),r=s(5346),n=s(5878),i=a._(s(5084));function c(e){let{props:t}=(0,r.getImgProps)(e,{defaultLoader:i.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,s]of Object.entries(t))void 0===s&&delete t[e];return{props:t}}let l=n.Image},4368:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var a=s(7437),r=s(2265),n=s(9376),i=s(3145),c=s(7648),l=s(6305),d=s(9714),o=s(7279),u=s(2660),h=s(8226),p=s(9322),x=s(1671),m=s(1723),y=s(9388),f=s(1817),g=s(2636);function j(){let e=e=>"".concat(e.productId,"-").concat(JSON.stringify(e.selectedOptions||{})),t=(0,n.useParams)(),s=(0,n.useRouter)(),j=(0,n.useSearchParams)(),v=t.id,[N,k]=(0,r.useState)(null),[b,w]=(0,r.useState)(null),[Z,A]=(0,r.useState)(!0),[S,P]=(0,r.useState)(!1),[M,C]=(0,r.useState)(null),[z,E]=(0,r.useState)(!1),[O,I]=(0,r.useState)({});(0,r.useEffect)(()=>{F(),U()},[v]),(0,r.useEffect)(()=>{if(!(null==N?void 0:N.items)||0===N.items.length)return;let e=N.items.map(e=>e.productId).filter(e=>!O[e]);if(0===e.length)return;let t=!1;return(async()=>{try{let s=await Promise.all(e.map(async e=>{try{let t=await l.x.get("/store/products/".concat(e));return{id:e,product:t.data.data}}catch(e){return null}}));if(t)return;I(e=>{let t=!1,a={...e};return s.forEach(e=>{if(null==e?void 0:e.product){let s=(0,o.b6)(e.product);s&&a[e.id]!==s&&(a[e.id]=s,t=!0)}}),t?a:e})}catch(e){}})(),()=>{t=!0}},[null==N?void 0:N.items,O]),(0,r.useEffect)(()=>{("true"===j.get("verify")||j.get("status"))&&(null==b?void 0:b.status)==="PENDING"&&G()},[b,j]);let F=async()=>{try{let e=await l.x.get("/store/orders/".concat(v));k(e.data.data)}catch(e){console.error("Failed to fetch order",e),s.push("/account/orders")}finally{A(!1)}},U=async()=>{try{let e=((await l.x.get("/store/payments/order/".concat(v))).data.data||[]).slice().sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime())[0];w(e||null)}catch(e){console.log("No payment found for order",e)}},G=async()=>{var e,t,s;if((null==b?void 0:b.id)&&!S){P(!0),C(null);try{let t=await l.x.get("/store/payments/".concat(b.id,"/verify"));w(t.data.data),E(!0),(null===(e=t.data.data)||void 0===e?void 0:e.status)==="SUCCESS"&&await F()}catch(e){console.error("Failed to verify payment",e),C((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"Failed to verify payment status")}finally{P(!1)}}},D=async()=>{var e,t,s;try{let t=await l.x.post("/store/payments/".concat(v,"/initiate"),{orderId:v,idempotencyKey:crypto.randomUUID(),callbackUrl:"".concat(window.location.origin,"/account/orders/").concat(v,"?verify=true")});(null===(e=t.data.data)||void 0===e?void 0:e.checkoutUrl)&&(window.location.href=t.data.data.checkoutUrl)}catch(e){console.error("Failed to initiate payment",e),C((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"Failed to initiate payment")}};return Z?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(d.Od,{className:"h-8 w-48"}),(0,a.jsx)(d.Od,{className:"h-64 w-full rounded-lg"}),(0,a.jsx)(d.Od,{className:"h-48 w-full rounded-lg"})]}):N?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(c.default,{href:"/account/orders",className:"p-2 text-gray-400 hover:text-primary",children:(0,a.jsx)(u.Z,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold text-gray-900",children:["Order ",N.id.slice(0,8).toUpperCase()]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Placed on ",(0,o.p6)(N.createdAt)]})]})]}),(0,a.jsx)(d.OE,{status:N.status})]}),b&&(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)(h.Z,{className:"h-5 w-5 text-gray-400"}),(0,a.jsx)("h2",{className:"font-semibold text-gray-900",children:"Payment Status"})]}),M&&(0,a.jsxs)("div",{className:"mb-4 p-3 bg-error-bg text-error rounded-lg text-sm flex items-center gap-2",children:[(0,a.jsx)(p.Z,{className:"h-4 w-4 flex-shrink-0"}),M]}),b?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Status"}),(0,a.jsxs)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat("SUCCESS"===b.status?"bg-green-100 text-green-800":"PENDING"===b.status?"bg-yellow-100 text-yellow-800":"FAILED"===b.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:["SUCCESS"===b.status&&(0,a.jsx)(x.Z,{className:"h-4 w-4 inline mr-1"}),"PENDING"===b.status&&(0,a.jsx)(m.Z,{className:"h-4 w-4 inline mr-1"}),"FAILED"===b.status&&(0,a.jsx)(y.Z,{className:"h-4 w-4 inline mr-1"}),b.status]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Amount"}),(0,a.jsx)("span",{className:"font-semibold",children:(0,o.xG)(b.amount)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Gateway"}),(0,a.jsx)("span",{children:b.gateway})]}),b.transactionRef&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Reference"}),(0,a.jsx)("span",{className:"font-mono text-sm",children:b.transactionRef})]}),b.failureReason&&(0,a.jsxs)("div",{className:"mt-3 p-3 bg-red-50 text-red-700 rounded-lg text-sm",children:[(0,a.jsx)("strong",{children:"Failed:"})," ",b.failureReason]}),z&&"SUCCESS"===b.status&&(0,a.jsxs)("div",{className:"mt-3 p-3 bg-green-50 text-green-700 rounded-lg text-sm flex items-center gap-2",children:[(0,a.jsx)(x.Z,{className:"h-4 w-4"}),"Payment verified successfully"]}),(0,a.jsxs)("div",{className:"mt-4 flex gap-3",children:["PENDING"===b.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(d.zx,{onClick:G,disabled:S,variant:"outline",className:"flex-1",children:[S?(0,a.jsx)(f.Z,{className:"h-4 w-4 mr-2 animate-spin"}):(0,a.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Check Status"]}),b.checkoutUrl&&(0,a.jsx)(d.zx,{onClick:()=>window.location.href=b.checkoutUrl,className:"flex-1",children:"Complete Payment"})]}),"FAILED"===b.status&&(0,a.jsx)(d.zx,{onClick:D,className:"flex-1",children:"Retry Payment"})]})]}):null]}),!b&&"PENDING"===N.status&&(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6 text-center",children:[(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"No payment found for this order yet."}),(0,a.jsx)(d.zx,{onClick:D,children:"Pay Now"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsx)("h2",{className:"font-semibold text-gray-900",children:"Order Items"})}),(0,a.jsx)("div",{className:"divide-y divide-gray-200",children:N.items.map(t=>(0,a.jsxs)("div",{className:"flex gap-4 p-6",children:[(0,a.jsx)("div",{className:"relative w-20 h-20 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0 flex items-center justify-center text-gray-400 text-xs",children:O[t.productId]?(0,a.jsx)(i.default,{src:O[t.productId],alt:t.productName,fill:!0,sizes:"80px",className:"object-cover"}):"No Image"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:t.productName}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["SKU: ",t.sku]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Qty: ",t.quantity]}),t.selectedOptions&&Object.keys(t.selectedOptions).length>0&&(0,a.jsx)("div",{className:"mt-2 text-xs text-gray-500 space-y-1",children:Object.entries(t.selectedOptions).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"uppercase tracking-wider text-gray-400",children:t}),(0,a.jsx)("span",{className:"font-medium text-gray-600",children:s})]},t)})})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"font-semibold text-gray-900",children:(0,o.xG)(t.subtotal)}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[(0,o.xG)(t.priceAtOrder)," each"]})]})]},e(t)))}),(0,a.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200",children:(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsxs)("div",{className:"flex justify-between text-lg font-semibold text-gray-900 pt-2 border-t border-gray-200",children:[(0,a.jsx)("span",{children:"Total"}),(0,a.jsx)("span",{children:(0,o.xG)(N.totalAmount)})]})})})]}),N.shippingAddress&&(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,a.jsx)("h2",{className:"font-semibold text-gray-900 mb-4",children:"Shipping Address"}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[N.shippingAddress.street&&(0,a.jsx)("p",{children:N.shippingAddress.street}),(N.shippingAddress.city||N.shippingAddress.region)&&(0,a.jsxs)("p",{children:[N.shippingAddress.city,N.shippingAddress.city&&N.shippingAddress.region?", ":"",N.shippingAddress.region]}),N.shippingAddress.country&&(0,a.jsx)("p",{children:N.shippingAddress.country}),N.shippingAddress.postalCode&&(0,a.jsxs)("p",{children:["Postal Code: ",N.shippingAddress.postalCode]}),N.shippingAddress.phone&&(0,a.jsxs)("p",{children:["Phone: ",N.shippingAddress.phone]}),N.shippingAddress.gps&&(0,a.jsxs)("p",{children:["GPS: ",N.shippingAddress.gps]})]})]})]}):null}}},function(e){e.O(0,[2972,6853,5878,9714,2971,2117,1744],function(){return e(e.s=2102)}),_N_E=e.O()}]);